EMU8086 GENERATED LISTING. MACHINE CODE <- SOURCE.
 
DES.exe -- emu8086 assembler version: 4.08  
 
[ 6/15/2017  --  1:55:40 AM ] 
 
===================================================================================================
[LINE]     LOC: MACHINE CODE                          SOURCE
===================================================================================================
 
[   1]        :                                       ; multi-segment executable file template.
[   2]        :                                       
[   3]        :                                       data segment
[   4]        :                                       ;the message after converted to hexa
[   5]    0000: 00 00 00 00 00 00 00 00               m db 8 dup(0)
[   6]        :                                       ;encryption key that was choosed by the user
[   7]    0008: 00 00 00 00 00 00 00 00               ekey db 8 dup(0)
[   8]        :                                       ;pc-1 means - bit arrangment to create the permuted key - k+
[   9]    0010: 39 31 29 21 19 11 09                  pc_1 db 57,49,41,33,25,17,09
[  10]    0017: 01 3A 32 2A 22 1A 12                  db 01,58,50,42,34,26,18
[  11]    001E: 0A 02 3B 33 2B 23 1B                  db 10,02,59,51,43,35,27
[  12]    0025: 13 0B 03 3C 34 2C 24                  db 19,11,03,60,52,44,36
[  13]    002C: 3F 37 2F 27 1F 17 0F                  db 63,55,47,39,31,23,15
[  14]    0033: 07 3E 36 2E 26 1E 16                  db 07,62,54,46,38,30,22
[  15]    003A: 0E 06 3D 35 2D 25 1D                  db 14,06,61,53,45,37,29
[  16]    0041: 15 0D 05 1C 14 0C 04                  db 21,13,05,28,20,12,04
[  17]        :                                       
[  18]    0048: 0E 11 0B 18 01 05                     pc_2 db 14,17,11,24,01,05
[  19]    004E: 03 1C 0F 06 15 0A                     db 03,28,15,06,21,10
[  20]    0054: 17 13 0C 04 1A 08                     db 23,19,12,04,26,08
[  21]    005A: 10 07 1B 14 0D 02                     db 16,07,27,20,13,02
[  22]    0060: 29 34 1F 25 2F 37                     db 41,52,31,37,47,55
[  23]    0066: 1E 28 33 2D 21 30                     db 30,40,51,45,33,48
[  24]    006C: 2C 31 27 38 22 35                     db 44,49,39,56,34,53
[  25]    0072: 2E 2A 32 24 1D 20                     db 46,42,50,36,29,32
[  26]        :                                       
[  27]    0078: 3A 32 2A 22 1A 12 0A 02               ip_tbl db 58,50,42,34,26,18,10,02
[  28]    0080: 3C 34 2C 24 1C 14 0C 04               db 60,52,44,36,28,20,12,04
[  29]    0088: 3E 36 2E 26 1E 16 0E 06               db 62,54,46,38,30,22,14,06
[  30]    0090: 40 38 30 28 20 18 10 08               db 64,56,48,40,32,24,16,08
[  31]    0098: 39 31 29 21 19 11 09 01               db 57,49,41,33,25,17,09,01
[  32]    00A0: 3B 33 2B 23 1B 13 0B 03               db 59,51,43,35,27,19,11,03
[  33]    00A8: 3D 35 2D 25 1D 15 0D 05               db 61,53,45,37,29,21,13,05
[  34]    00B0: 3F 37 2F 27 1F 17 0F 07               db 63,55,47,39,31,23,15,07
[  35]        :                                       
[  36]    00B8: 20 01 02 03 04 05                     e_tbl db 32,01,02,03,04,05
[  37]    00BE: 04 05 06 07 08 09                     db 04,05,06,07,08,09
[  38]    00C4: 08 09 0A 0B 0C 0D                     db 08,09,10,11,12,13
[  39]    00CA: 0C 0D 0E 0F 10 11                     db 12,13,14,15,16,17
[  40]    00D0: 10 11 12 13 14 15                     db 16,17,18,19,20,21
[  41]    00D6: 14 15 16 17 18 19                     db 20,21,22,23,24,25
[  42]    00DC: 18 19 1A 1B 1C 1D                     db 24,25,26,27,28,29
[  43]    00E2: 1C 1D 1E 1F 20 01                     db 28,29,30,31,32,01
[  44]        :                                       
[  45]        :                                       
[  46]        :                                       
[  47]    00E8: 0E 04 0D 01 02 0F 0B 08 03 0A 06 0C   s1 db 14,04,13,01,02,15,11,08,03,10,06,12,05,09,00,07
                05 09 00 07                         
[  48]    00F8: 00 0F 07 04 0E 02 0D 01 0A 06 0C 0B   db 00,15,07,04,14,02,13,01,10,06,12,11,09,05,03,08
                09 05 03 08                         
[  49]    0108: 04 01 0E 08 0D 06 02 0B 0F 0C 09 07   db 04,01,14,08,13,06,02,11,15,12,09,07,03,10,05,00
                03 0A 05 00                         
[  50]    0118: 0F 0C 08 02 04 09 01 07 05 0B 03 0E   db 15,12,08,02,04,09,01,07,05,11,03,14,10,00,06,13
                0A 00 06 0D                         
[  51]        :                                       
[  52]        :                                       
[  53]    0128: 0F 01 08 0E 06 0B 03 04 09 07 02 0D   s2 db 15,01,08,14,06,11,03,04,09,07,02,13,12,00,05,10
                0C 00 05 0A                         
[  54]    0138: 03 0D 04 07 0F 02 08 0E 0C 00 01 0A   db 03,13,04,07,15,02,08,14,12,00,01,10,06,09,11,05
                06 09 0B 05                         
[  55]    0148: 00 0E 07 0B 0A 04 0D 01 05 08 0C 06   db 00,14,07,11,10,04,13,01,05,08,12,06,09,03,02,15
                09 03 02 0F                         
[  56]    0158: 0D 08 0A 01 03 0F 04 02 0B 06 07 0C   db 13,08,10,01,03,15,04,02,11,06,07,12,00,05,14,09
                00 05 0E 09                         
[  57]        :                                       
[  58]        :                                       
[  59]    0168: 0A 00 09 0E 06 03 0F 05 01 0D 0C 07   s3 db 10,00,09,14,06,03,15,05,01,13,12,07,11,04,02,08
                0B 04 02 08                         
[  60]    0178: 0D 07 00 09 03 04 06 0A 02 08 05 0E   db 13,07,00,09,03,04,06,10,02,08,05,14,12,11,15,01
                0C 0B 0F 01                         
[  61]    0188: 0D 06 04 09 08 0F 03 00 0B 01 02 0C   db 13,06,04,09,08,15,03,00,11,01,02,12,05,10,14,07
                05 0A 0E 07                         
[  62]    0198: 01 0A 0D 00 06 09 08 07 04 0F 0E 03   db 01,10,13,00,06,09,08,07,04,15,14,03,11,05,02,12
                0B 05 02 0C                         
[  63]        :                                       
[  64]        :                                       
[  65]    01A8: 07 0D 0E 03 00 06 09 0A 01 02 08 05   s4 db 07,13,14,03,00,06,09,10,01,02,08,05,11,12,04,15
                0B 0C 04 0F                         
[  66]    01B8: 0D 08 0B 05 06 0F 00 03 04 07 02 0C   db 13,08,11,05,06,15,00,03,04,07,02,12,01,10,14,09
                01 0A 0E 09                         
[  67]    01C8: 0A 06 09 00 0C 0B 07 0D 0F 01 03 0E   db 10,06,09,00,12,11,07,13,15,01,03,14,05,02,08,04
                05 02 08 04                         
[  68]    01D8: 03 0F 00 06 0A 01 0D 08 09 04 05 0B   db 03,15,00,06,10,01,13,08,09,04,05,11,12,07,02,14
                0C 07 02 0E                         
[  69]        :                                       
[  70]        :                                       
[  71]    01E8: 02 0C 04 01 07 0A 0B 06 08 05 03 0F   s5 db 02,12,04,01,07,10,11,06,08,05,03,15,13,00,14,09
                0D 00 0E 09                         
[  72]    01F8: 0E 0B 02 0C 04 07 0D 01 05 00 0F 0A   db 14,11,02,12,04,07,13,01,05,00,15,10,03,09,08,06
                03 09 08 06                         
[  73]    0208: 04 02 01 0B 0A 0D 07 08 0F 09 0C 05   db 04,02,01,11,10,13,07,08,15,09,12,05,06,03,00,14
                06 03 00 0E                         
[  74]    0218: 0B 08 0C 07 01 0E 02 0D 06 0F 00 09   db 11,08,12,07,01,14,02,13,06,15,00,09,10,04,05,03
                0A 04 05 03                         
[  75]        :                                       
[  76]        :                                       
[  77]    0228: 0C 01 0A 0F 09 02 06 08 00 0D 03 04   s6 db 12,01,10,15,09,02,06,08,00,13,03,04,14,07,05,11
                0E 07 05 0B                         
[  78]    0238: 0A 0F 04 02 07 0C 09 05 06 01 0D 0E   db 10,15,04,02,07,12,09,05,06,01,13,14,00,11,03,08
                00 0B 03 08                         
[  79]    0248: 09 0E 0F 05 02 08 0C 03 07 00 04 0A   db 09,14,15,05,02,08,12,03,07,00,04,10,01,13,11,06
                01 0D 0B 06                         
[  80]    0258: 04 03 02 0C 09 05 0F 0A 0B 0E 01 07   db 04,03,02,12,09,05,15,10,11,14,01,07,06,00,08,13
                06 00 08 0D                         
[  81]        :                                       
[  82]        :                                       
[  83]    0268: 04 0B 02 0E 0F 00 08 0D 03 0C 09 07   s7 db 04,11,02,14,15,00,08,13,03,12,09,07,05,10,06,01
                05 0A 06 01                         
[  84]    0278: 0D 00 0B 07 04 09 01 0A 0E 03 05 0C   db 13,00,11,07,04,09,01,10,14,03,05,12,02,15,08,06
                02 0F 08 06                         
[  85]    0288: 01 04 0B 0D 0C 03 07 0E 0A 0F 06 08   db 01,04,11,13,12,03,07,14,10,15,06,08,00,05,09,02
                00 05 09 02                         
[  86]    0298: 06 0B 0D 08 01 04 0A 07 09 05 00 0F   db 06,11,13,08,01,04,10,07,09,05,00,15,14,02,03,12
                0E 02 03 0C                         
[  87]        :                                       
[  88]        :                                       
[  89]    02A8: 0D 02 08 04 06 0F 0B 01 0A 09 03 0E   s8 db 13,02,08,04,06,15,11,01,10,09,03,14,05,00,12,07
                05 00 0C 07                         
[  90]    02B8: 01 0F 0D 08 0A 03 07 04 0C 05 06 0B   db 01,15,13,08,10,03,07,04,12,05,06,11,00,14,09,02
                00 0E 09 02                         
[  91]    02C8: 07 0B 04 01 09 0C 0E 02 00 06 0A 0D   db 07,11,04,01,09,12,14,02,00,06,10,13,15,03,05,08
                0F 03 05 08                         
[  92]    02D8: 02 01 0E 07 04 0A 08 0D 0F 0C 09 00   db 02,01,14,07,04,10,08,13,15,12,09,00,03,05,06,11
                03 05 06 0B                         
[  93]        :                                       
[  94]    02E8: 10 07 14 15                           p db 16,07,20,21
[  95]    02EC: 1D 0C 1C 11                           db 29,12,28,17
[  96]    02F0: 01 0F 17 1A                           db 01,15,23,26
[  97]    02F4: 05 12 1F 0A                           db 05,18,31,10
[  98]    02F8: 02 08 18 0E                           db 02,08,24,14
[  99]    02FC: 20 1B 03 09                           db 32,27,03,09
[ 100]    0300: 13 0D 1E 06                           db 19,13,30,06
[ 101]    0304: 16 0B 04 19                           db 22,11,04,25
[ 102]        :                                       
[ 103]        :                                       
[ 104]    0308: 28 08 30 10 38 18 40 20               pc_minus db 40,08,48,16,56,24,64,32
[ 105]    0310: 27 07 2F 0F 37 17 3F 1F               db 39,07,47,15,55,23,63,31
[ 106]    0318: 26 06 2E 0E 36 16 3E 1E               db 38,06,46,14,54,22,62,30
[ 107]    0320: 25 05 2D 0D 35 15 3D 1D               db 37,05,45,13,53,21,61,29
[ 108]    0328: 24 04 2C 0C 34 14 3C 1C               db 36,04,44,12,52,20,60,28
[ 109]    0330: 23 03 2B 0B 33 13 3B 1B               db 35,03,43,11,51,19,59,27
[ 110]    0338: 22 02 2A 0A 32 12 3A 1A               db 34,02,42,10,50,18,58,26
[ 111]    0340: 21 01 29 09 31 11 39 19               db 33,01,41,09,49,17,57,25
[ 112]        :                                       
[ 113]        :                                       
[ 114]    0348: 00 00 00 00 00 00 00                  k_plus db 7 dup(00)
[ 115]    034F: 00                                    selected_byte db ?
[ 116]    0350: 00                                    selected_bit db  ?
[ 117]    0351: 00                                    temp_byte db 00000000b
[ 118]    0352: 00                                    byte_builder_pointer db 0
[ 119]    0353: 00 00                                 pointer dw 0000h
[ 120]    0355: 00 00 00 00                           k_plus_l dd 0h
[ 121]    0359: 00 00 00 00                           k_plus_r dd 0h
[ 122]    035D: 01 01 02 02 02 02 02 02 01 02 02 02   shifts db 01,01,02,02,02,02,02,02,01,02,02,02,02,02,02,01
                02 02 02 01                         
[ 123]    036D: 00 00 00 00 00 00 00 00 00 00 00 00   c dd 0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h,0h
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00                         
[ 124]    03AD: 00 00 00 00 00 00 00 00 00 00 00 00   d dd 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00                         
[ 125]    03ED: 00 00 00 00 00 00 00 00 00 00 00 00   cd db 112 dup(0)
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00                         
[ 126]    045D: 00 00 00 00                           temp_dword dd 00000000h
[ 127]    0461: 00 00 00 00 00 00 00 00 00 00 00 00   k db 96 dup(0)
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                                                    
[ 128]    04C1: 00                                    para db 00h ;multipurpose parameter
[ 129]    04C2: 00 00 00 00 00 00 00 00               ip db 8 dup(0)
[ 130]    04CA: 00 00 00 00                           l_0 db 4 dup(0)
[ 131]    04CE: 00 00 00 00                           r_0 db 4 dup(0)
[ 132]    04D2: 00 00 00 00 00 00 00 00 00 00 00 00   l db 64 dup(0)
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00                         
[ 133]    0512: 00 00 00 00 00 00 00 00 00 00 00 00   r db 64 dup(0)
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00                         
[ 134]    0552: 00 00 00 00 00 00                     e db 6 dup(0)
[ 135]    0558: 00                                    l_index db 0
[ 136]    0559: 00                                    r_index db 0
[ 137]    055A: 00 00 00 00 00 00 00 00               b db 8 dup(0)
[ 138]    0562: 00                                    s_row db 0
[ 139]    0563: 00                                    s_column db 0
[ 140]    0564: 00 00 00 00                           s db 4 dup(0)
[ 141]    0568: 00 00 00 00                           f db 4 dup(0)
[ 142]    056C: 00 00                                 temp_offset1 dw 0000h
[ 143]    056E: 00 00                                 temp_offset2 dw 0000h
[ 144]    0570: 00 00 00 00                           temp_arr db 4 dup(0)
[ 145]    0574: 00 00 00 00                           lp db 4 dup(0)
[ 146]    0578: 00 00 00 00 00 00 00 00               rl db 8 dup(0)
[ 147]    0580: 00 00 00 00                           rp db 4 dup(0)
[ 148]    0584: 00 00 00 00 00 00 00 00               dec_msg db 8 dup(0)
[ 149]    058C: 00 00 00 00 00 00 00 00               enc_msg db 8 dup(0)
[ 150]    0594: 00 00 00 00 00 00 00 00 00 00 00 00   m_ascii db 19 dup(0)
                00 00 00 00 00 00 00                
[ 151]    05A7: 00 00 00 00 00 00 00 00 00 00 00 00   ekey_ascii db 19 dup(0)
                00 00 00 00 00 00 00                
[ 152]    05BA: 00 00 00 00 00 00 00 00 00 00 00 00   enc_msg_ascii 16 dup(0),"$"
                00 00 00 00 24                      
[ 153]    05CB: 00 00 00 00 00 00 00 00 00 00 00 00   dec_msg_ascii db 16 dup(0),"$"
                00 00 00 00 24                      
[ 154]    05DC: 59 6F 75 20 74 79 70 65 64 20 69 6E   error_msg db "You typed in some invaild input, check help for list of command.",10,"Prees any key to start over...","$"
                20 73 6F 6D 65 20 69 6E 76 61 69 6C 
                64 20 69 6E 70 75 74 2C 20 63 68 65 
                63 6B 20 68 65 6C 70 20 66 6F 72 20 
                6C 69 73 74 20 6F 66 20 63 6F 6D 6D 
                61 6E 64 2E 0A 50 72 65 65 73 20 61 
                6E 79 20 6B 65 79 20 74 6F 20 73 74 
                61 72 74 20 6F 76 65 72 2E 2E 2E 24 
                                                    
[ 155]    063C: 50 6C 65 61 73 65 20 65 6E 74 65 72   ask_msg db "Please enter the 16 charecters length hexa message:","$"
                20 74 68 65 20 31 36 20 63 68 61 72 
                65 63 74 65 72 73 20 6C 65 6E 67 74 
                68 20 68 65 78 61 20 6D 65 73 73 61 
                67 65 3A 24                         
[ 156]    0670: 50 6C 65 61 73 65 20 65 6E 74 65 72   ask_enc db "Please enter the 16 charecters length hexa encrypted message:","$"
                20 74 68 65 20 31 36 20 63 68 61 72 
                65 63 74 65 72 73 20 6C 65 6E 67 74 
                68 20 68 65 78 61 20 65 6E 63 72 79 
                70 74 65 64 20 6D 65 73 73 61 67 65 
                3A 24                               
[ 157]    06AE: 50 6C 65 61 73 65 20 65 6E 74 65 72   ask_key db "Please enter the 16 charecters length hexa encryption key:","$"
                20 74 68 65 20 31 36 20 63 68 61 72 
                65 63 74 65 72 73 20 6C 65 6E 67 74 
                68 20 68 65 78 61 20 65 6E 63 72 79 
                70 74 69 6F 6E 20 6B 65 79 3A 24    
[ 158]    06E9: 50 6C 65 61 73 65 20 65 6E 74 65 72   ask_dec_key db "Please enter the 16 charecters length hexa decryption key:","$"
                20 74 68 65 20 31 36 20 63 68 61 72 
                65 63 74 65 72 73 20 6C 65 6E 67 74 
                68 20 68 65 78 61 20 64 65 63 72 79 
                70 74 69 6F 6E 20 6B 65 79 3A 24    
[ 159]    0724: 54 68 69 73 20 69 73 20 74 68 65 20   show_enc db "This is the encrypted message:","$"
                65 6E 63 72 79 70 74 65 64 20 6D 65 
                73 73 61 67 65 3A 24                
[ 160]    0743: 54 68 69 73 20 69 73 20 74 68 65 20   show_dec db "This is the encrypted message:","$"
                65 6E 63 72 79 70 74 65 64 20 6D 65 
                73 73 61 67 65 3A 24                
[ 161]    0762: 45 6E 74 65 72 20 63 6F 6D 6D 61 6E   ask_command db "Enter command:","$"
                64 3A 24                            
[ 162]    0771: 4C 69 73 74 20 6F 66 20 63 6F 6D 6D   help_msg db "List of commands:",10,"e -  encrypt message using DES algorithm.",10,"d - decrypt message using DES algorithm.",10,10,"*notice - all encrytion/decryption input has to be 16 charecters length",10," hexadecimal number",10,"without extra zero in the start,or h at the end","$"
                61 6E 64 73 3A 0A 65 20 2D 20 20 65 
                6E 63 72 79 70 74 20 6D 65 73 73 61 
                67 65 20 75 73 69 6E 67 20 44 45 53 
                20 61 6C 67 6F 72 69 74 68 6D 2E 0A 
                64 20 2D 20 64 65 63 72 79 70 74 20 
                6D 65 73 73 61 67 65 20 75 73 69 6E 
                67 20 44 45 53 20 61 6C 67 6F 72 69 
                74 68 6D 2E 0A 0A 2A 6E 6F 74 69 63 
                65 20 2D 20 61 6C 6C 20 65 6E 63 72 
                79 74 69 6F 6E 2F 64 65 63 72 79 70 
                74 69 6F 6E 20 69 6E 70 75 74 20 68 
                61 73 20 74 6F 20 62 65 20 31 36 20 
                63 68 61 72 65 63 74 65 72 73 20 6C 
                65 6E 67 74 68 0A 20 68 65 78 61 64 
                65 63 69 6D 61 6C 20 6E 75 6D 62 65 
                72 0A 77 69 74 68 6F 75 74 20 65 78 
                74 72 61 20 7A 65 72 6F 20 69 6E 20 
                74 68 65 20 73 74 61 72 74 2C 6F 72 
                20 68 20 61 74 20 74 68 65 20 65 6E 
                64 24                               
[ 163]    0863: 48 65 6C 6C 6F 2C 20 77 65 6C 63 6F   welcome_msg db "Hello, welcome to DES encryptor/decryptor."
                6D 65 20 74 6F 20 44 45 53 20 65 6E 
                63 72 79 70 74 6F 72 2F 64 65 63 72 
                79 70 74 6F 72 2E                   
[ 164]    088D: 00 00 00 00 24                        command db 4 dup(0),"$"
[ 165]    0892: 50 72 65 73 73 20 61 6E 79 20 6B 65   wait_key db "Press any key to continue..."
                79 20 74 6F 20 63 6F 6E 74 69 6E 75 
                65 2E 2E 2E                         
[ 166]    08AE: 68 65 6C 70                           help db "help"
[ 167]    08B2: 48 45 4C 50                           chelp db "HELP"
[ 168]    08B6: 65 6E 63                              enc db "enc"
[ 169]    08B9: 45 4E 43                              cenc db "ENC"
[ 170]    08BC: 64 65 63                              decr db "dec"
[ 171]    08BF: 44 45 43                              cdecr db "DEC"
[ 172]    08C2: 65 78 69 74                           exit db  "exit"
[ 173]    08C6: 45 58 49 54                           cexit db "EXIT"
[ 174]        :                                       
[ 175]        :                                       
[ 176]        :                                       
[ 177]        :                                       
[ 178]        :                                       
[ 179]        :                                       ends
[ 180]        :                                       
[ 181]        :                                       stack segment
[ 182]    08D0: 00 00 00 00 00 00 00 00 00 00 00 00   dw   128  dup(0)
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00 00 00 00 00 00 00 00 00 
                00 00 00 00                         
[ 183]        :                                       ends
[ 184]        :                                       
[ 185]        :                                       code segment
[ 186]        :                                       
[ 187]        :                                       ;INPUT OUTPUT
[ 188]        :                                       ;gets input
[ 189]        :                                       ;get:dest,length
[ 190]        :                                       ;return:string
[ 191]        :                                       macro get_input dest,len
[ 192]        :                                       pusha
[ 193]        :                                       ;new line
[ 194]        :                                       mov al,10
[ 195]        :                                       mov ah,1
[ 196]        :                                       int 10h
[ 197]        :                                       mov dx,offset dest
[ 198]        :                                       mov bx,dx
[ 199]        :                                       mov cl,len
[ 200]        :                                       inc cl
[ 201]        :                                       mov [bx],cl
[ 202]        :                                       mov ah,0ah
[ 203]        :                                       int 21h
[ 204]        :                                       popa
[ 205]        :                                       endm get_input
[ 206]        :                                       ;converts string to hexa
[ 207]        :                                       ;get:source,dest
[ 208]        :                                       ;return: hexa in dest
[ 209]        :                                       macro str2hex source,dest
[ 210]        :                                       pusha
[ 211]        :                                       LOCAL agn_bld_char,goback,error,check_hex,skp_hex,check_cap,skp_1st_char,end_str
[ 212]        :                                       xor di,di
[ 213]        :                                       xor si,si
[ 214]        :                                       mov si,2
[ 215]        :                                       xor cx,cx
[ 216]        :                                       mov cx,8
[ 217]        :                                       agn_bld_char:
[ 218]        :                                       mov pointer,0
[ 219]        :                                       xor ax,ax
[ 220]        :                                       xor dx,dx
[ 221]        :                                       xor bx,bx
[ 222]        :                                       goback:
[ 223]        :                                       mov al,source+si
[ 224]        :                                       
[ 225]        :                                       ;check
[ 226]        :                                       cmp al,30h
[ 227]        :                                       js error
[ 228]        :                                       mov bl,39h
[ 229]        :                                       cmp bl,al
[ 230]        :                                       js check_hex
[ 231]        :                                       sub al,30h
[ 232]        :                                       jmp skp_hex
[ 233]        :                                       
[ 234]        :                                       check_hex:
[ 235]        :                                       cmp al,41h
[ 236]        :                                       js error
[ 237]        :                                       mov bl,46h
[ 238]        :                                       cmp bl,al
[ 239]        :                                       js check_cap
[ 240]        :                                       sub al,55
[ 241]        :                                       jmp skp_hex
[ 242]        :                                       
[ 243]        :                                       check_cap:
[ 244]        :                                       cmp al,61h
[ 245]        :                                       js error
[ 246]        :                                       mov bl,66h
[ 247]        :                                       cmp bl,al
[ 248]        :                                       js error
[ 249]        :                                       sub al,87
[ 250]        :                                       
[ 251]        :                                       skp_hex:
[ 252]        :                                       
[ 253]        :                                       cmp pointer,0
[ 254]        :                                       jnz skp_1st_char
[ 255]        :                                       inc si
[ 256]        :                                       inc pointer
[ 257]        :                                       mov dh,al
[ 258]        :                                       jmp goback
[ 259]        :                                       skp_1st_char:
[ 260]        :                                       mov bl,10h
[ 261]        :                                       mov dl,al
[ 262]        :                                       mov al,dh
[ 263]        :                                       mul bl
[ 264]        :                                       mov dh,al
[ 265]        :                                       or dh,dl
[ 266]        :                                       mov dest+di,dh
[ 267]        :                                       inc si
[ 268]        :                                       inc di
[ 269]        :                                       loop agn_bld_char
[ 270]        :                                       
[ 271]        :                                       jmp end_str
[ 272]        :                                       error:
[ 273]        :                                       ;reset screen
[ 274]        :                                       call cln_scr
[ 275]        :                                       set_cur 0,0
[ 276]        :                                       print_msg error_msg
[ 277]        :                                       ; wait for any key....
[ 278]        :                                       mov ah, 1
[ 279]        :                                       int 21h
[ 280]        :                                       jmp ask_again
[ 281]        :                                       
[ 282]        :                                       end_str:
[ 283]        :                                       popa
[ 284]        :                                       endm str2hex
[ 285]        :                                       ;prints message
[ 286]        :                                       ;get:msg
[ 287]        :                                       macro print_msg pmsg
[ 288]        :                                       pusha
[ 289]        :                                       mov ah,09h
[ 290]        :                                       mov dx,offset pmsg
[ 291]        :                                       int 21h
[ 292]        :                                       
[ 293]        :                                       
[ 294]        :                                       popa
[ 295]        :                                       endm print_msg
[ 296]        :                                       ;cleans screen
[ 297]    09D0:                                       proc cln_scr
[ 298]    09D0: 60                                    pusha
[ 299]        :                                       ;clean screen
[ 300]    09D1: B4 06                                 mov ah,6
[ 301]    09D3: B0 00                                 mov al,0
[ 302]    09D5: B7 0F                                 mov bh,0_0fh
[ 303]    09D7: 33 C9                                 xor cx,cx
[ 304]    09D9: B6 C8                                 mov dh,200
[ 305]    09DB: B2 C8                                 mov dl,200
[ 306]    09DD: CD 10                                 int 10h
[ 307]        :                                       
[ 308]    09DF: 61                                    popa
[ 309]    09E0: C3                                    ret
[ 310]        :                                       endp cln_scr
[ 311]        :                                       ;sets cursor position
[ 312]        :                                       ;get:x,y
[ 313]        :                                       macro set_cur x,y
[ 314]        :                                       ;set cursor
[ 315]        :                                       pusha
[ 316]        :                                       mov ah,2
[ 317]        :                                       mov bh,0
[ 318]        :                                       xor dx,dx
[ 319]        :                                       int 10h
[ 320]        :                                       popa
[ 321]        :                                       endm set_cur x,y
[ 322]        :                                       ;gets message and key
[ 323]    09E1:                                       proc get_msgnkey
[ 324]    09E1: 60                                    pusha
[ 325]        :                                       ;reset screen
[ 326]    09E2: E8 EB FF                              call cln_scr
[ 327]    09E5: 60 B4 02 B7 00 33 D2 CD 10 61         set_cur 0,0
[ 328]    09EF: 60 B4 09 BA 3C 06 CD 21 61            print_msg ask_msg
[ 329]    09F8: 60 B0 0A B4 01 CD 10 BA 94 05 8B DA   get_input m_ascii,16
                B1 10 FE C1 88 0F B4 0A CD 21 61    
[ 330]    0A0F: 60 33 FF 33 F6 BE 02 00 33 C9 B9 08   str2hex m_ascii,m
                00 C7 06 53 03 00 00 33 C0 33 D2 33 
                DB 8A 84 94 05 3C 30 78 48 B3 39 3A 
                D8 78 04 2C 30 EB 1A 3C 41 78 3A B3 
                46 3A D8 78 04 2C 37 EB 0C 3C 61 78 
                2C B3 66 3A D8 78 26 2C 57 83 3E 53 
                03 00 75 09 46 FF 06 53 03 8A F0 EB 
                C4 B3 10 8A D0 8A C6 F6 E3 8A F0 0A 
                F2 88 35 46 47 E2 A6 EB 1D E8 55 FF 
                60 B4 02 B7 00 33 D2 CD 10 61 60 B4 
                09 BA DC 05 CD 21 61 B4 01 CD 21 E9 
                E1 15 61                            
[ 331]        :                                       ;reset screen
[ 332]    0A96: E8 37 FF                              call cln_scr
[ 333]    0A99: 60 B4 02 B7 00 33 D2 CD 10 61         set_cur 0,0
[ 334]    0AA3: 60 B4 09 BA AE 06 CD 21 61            print_msg ask_key
[ 335]    0AAC: 60 B0 0A B4 01 CD 10 BA A7 05 8B DA   get_input ekey_ascii,16
                B1 10 FE C1 88 0F B4 0A CD 21 61    
[ 336]    0AC3: 60 33 FF 33 F6 BE 02 00 33 C9 B9 08   str2hex ekey_ascii,ekey
                00 C7 06 53 03 00 00 33 C0 33 D2 33 
                DB 8A 84 A7 05 3C 30 78 49 B3 39 3A 
                D8 78 04 2C 30 EB 1A 3C 41 78 3B B3 
                46 3A D8 78 04 2C 37 EB 0C 3C 61 78 
                2D B3 66 3A D8 78 27 2C 57 83 3E 53 
                03 00 75 09 46 FF 06 53 03 8A F0 EB 
                C4 B3 10 8A D0 8A C6 F6 E3 8A F0 0A 
                F2 88 75 08 46 47 E2 A5 EB 1D E8 A0 
                FE 60 B4 02 B7 00 33 D2 CD 10 61 60 
                B4 09 BA DC 05 CD 21 61 B4 01 CD 21 
                E9 2C 15 61                         
[ 337]    0B4B: 61                                    popa
[ 338]    0B4C: C3                                    ret
[ 339]        :                                       endp get_msgnkey
[ 340]        :                                       ;gets encrypted message and key.
[ 341]    0B4D:                                       proc get_encnkey
[ 342]    0B4D: 60                                    pusha
[ 343]        :                                       ;reset screen
[ 344]    0B4E: E8 7F FE                              call cln_scr
[ 345]    0B51: 60 B4 02 B7 00 33 D2 CD 10 61         set_cur 0,0
[ 346]    0B5B: 60 B4 09 BA 70 06 CD 21 61            print_msg ask_enc
[ 347]    0B64: 60 B0 0A B4 01 CD 10 BA BA 05 8B DA   get_input enc_msg_ascii,16
                B1 10 FE C1 88 0F B4 0A CD 21 61    
[ 348]    0B7B: 60 33 FF 33 F6 BE 02 00 33 C9 B9 08   str2hex enc_msg_ascii,enc_msg
                00 C7 06 53 03 00 00 33 C0 33 D2 33 
                DB 8A 84 BA 05 3C 30 78 4A B3 39 3A 
                D8 78 04 2C 30 EB 1A 3C 41 78 3C B3 
                46 3A D8 78 04 2C 37 EB 0C 3C 61 78 
                2E B3 66 3A D8 78 28 2C 57 83 3E 53 
                03 00 75 09 46 FF 06 53 03 8A F0 EB 
                C4 B3 10 8A D0 8A C6 F6 E3 8A F0 0A 
                F2 88 B5 8C 05 46 47 E2 A4 EB 1D E8 
                E7 FD 60 B4 02 B7 00 33 D2 CD 10 61 
                60 B4 09 BA DC 05 CD 21 61 B4 01 CD 
                21 E9 73 14 61                      
[ 349]        :                                       ;reset screen
[ 350]    0C04: E8 C9 FD                              call cln_scr
[ 351]    0C07: 60 B4 02 B7 00 33 D2 CD 10 61         set_cur 0,0
[ 352]    0C11: 60 B4 09 BA E9 06 CD 21 61            print_msg ask_dec_key
[ 353]    0C1A: 60 B0 0A B4 01 CD 10 BA A7 05 8B DA   get_input ekey_ascii,16
                B1 10 FE C1 88 0F B4 0A CD 21 61    
[ 354]    0C31: 60 33 FF 33 F6 BE 02 00 33 C9 B9 08   str2hex ekey_ascii,ekey
                00 C7 06 53 03 00 00 33 C0 33 D2 33 
                DB 8A 84 A7 05 3C 30 78 49 B3 39 3A 
                D8 78 04 2C 30 EB 1A 3C 41 78 3B B3 
                46 3A D8 78 04 2C 37 EB 0C 3C 61 78 
                2D B3 66 3A D8 78 27 2C 57 83 3E 53 
                03 00 75 09 46 FF 06 53 03 8A F0 EB 
                C4 B3 10 8A D0 8A C6 F6 E3 8A F0 0A 
                F2 88 75 08 46 47 E2 A5 EB 1D E8 32 
                FD 60 B4 02 B7 00 33 D2 CD 10 61 60 
                B4 09 BA DC 05 CD 21 61 B4 01 CD 21 
                E9 BE 13 61                         
[ 355]    0CB9: 61                                    popa
[ 356]    0CBA: C3                                    ret
[ 357]        :                                       endp get_encnkey
[ 358]        :                                       ;converts hexa to string
[ 359]        :                                       ;get:source,dest
[ 360]        :                                       ;return: string in dest
[ 361]        :                                       macro hex2str source,dest
[ 362]        :                                       pusha
[ 363]        :                                       LOCAL again,cont,cont1,skp_hex,skp_hex1
[ 364]        :                                       xor si,si
[ 365]        :                                       xor ax,ax
[ 366]        :                                       xor cx,cx
[ 367]        :                                       xor di,di
[ 368]        :                                       mov cx,8
[ 369]        :                                       again:
[ 370]        :                                       mov al,source+si
[ 371]        :                                       and al,11110000b
[ 372]        :                                       shr al,4
[ 373]        :                                       
[ 374]        :                                       
[ 375]        :                                       cmp al,0ah
[ 376]        :                                       js skp_hex
[ 377]        :                                       add al,55
[ 378]        :                                       mov dest+di,al
[ 379]        :                                       inc di
[ 380]        :                                       jmp cont
[ 381]        :                                       
[ 382]        :                                       skp_hex:
[ 383]        :                                       add al,30h
[ 384]        :                                       mov dest+di,al
[ 385]        :                                       inc di
[ 386]        :                                       
[ 387]        :                                       
[ 388]        :                                       cont:
[ 389]        :                                       mov al,source+si
[ 390]        :                                       and al,00001111b
[ 391]        :                                       
[ 392]        :                                       cmp al,0ah
[ 393]        :                                       js skp_hex1
[ 394]        :                                       add al,55
[ 395]        :                                       mov dest+di,al
[ 396]        :                                       inc di
[ 397]        :                                       jmp cont1
[ 398]        :                                       
[ 399]        :                                       skp_hex1:
[ 400]        :                                       add al,30h
[ 401]        :                                       mov dest+di,al
[ 402]        :                                       inc di
[ 403]        :                                       cont1:
[ 404]        :                                       inc si
[ 405]        :                                       loop again
[ 406]        :                                       popa
[ 407]        :                                       endm hex2str
[ 408]        :                                       
[ 409]        :                                       
[ 410]        :                                       
[ 411]        :                                       ;END INPUT OUTPUT
[ 412]        :                                       ;the macro gets double word var and number of left shift.
[ 413]        :                                       ;it returns the var left shifted.
[ 414]        :                                       macro shift_left dword,shft_no
[ 415]        :                                       pusha
[ 416]        :                                       xor ax,ax
[ 417]        :                                       xor bx,bx
[ 418]        :                                       xor si,si
[ 419]        :                                       xor di,di
[ 420]        :                                       xor cx,cx
[ 421]        :                                       xor dx,dx
[ 422]        :                                       
[ 423]        :                                       LOCAL shftt,contt,soff
[ 424]        :                                       
[ 425]        :                                       mov di,2
[ 426]        :                                       mov ax,dword+0
[ 427]        :                                       mov dx,dword+2
[ 428]        :                                       mov cl,shft_no
[ 429]        :                                       shftt:
[ 430]        :                                       rcl ax,1
[ 431]        :                                       pushf
[ 432]        :                                       and ax,1111111111111110b
[ 433]        :                                       rcl dx,1
[ 434]        :                                       pushf
[ 435]        :                                       and dx,1111111111111110b
[ 436]        :                                       popf
[ 437]        :                                       jnc contt
[ 438]        :                                       or ax,0000000000010000b
[ 439]        :                                       contt:
[ 440]        :                                       popf
[ 441]        :                                       jnc soff
[ 442]        :                                       or dx,0000000000000001b
[ 443]        :                                       soff:
[ 444]        :                                       loop shftt
[ 445]        :                                       mov dword+0,ax
[ 446]        :                                       mov dword+2,dx
[ 447]        :                                       popa
[ 448]        :                                       endm shift_left
[ 449]        :                                       
[ 450]        :                                       ;the macro permutate var using permutation table
[ 451]        :                                       ;get:p table,byte index,adding parameter(if not used keep on zero)
[ 452]        :                                       ;return: temp_byte containing the permutated byte.
[ 453]        :                                       macro permute_key pc_table,byte_no,key,addpara
[ 454]        :                                       
[ 455]        :                                       pusha
[ 456]        :                                       LOCAL again,skip_add,skip_check,skip_1,skip_2,skip_3,skip_4,skip_5,skip_6,skip_7,bit_1,bit_2,bit_3,bit_4,bit_5,bit_6,bit_7,end_bit_0,end_bit_1,end_bit_2,end_bit_3,end_bit_4,end_bit_5,end_bit_6,end_bit_7,end_builder,endd
[ 457]        :                                       xor ax,ax
[ 458]        :                                       xor bx,bx
[ 459]        :                                       xor cx,cx
[ 460]        :                                       xor dx,dx
[ 461]        :                                       mov pointer,0000h
[ 462]        :                                       mov temp_byte,00000000b
[ 463]        :                                       mov byte_builder_pointer,0h
[ 464]        :                                       mov ax,8
[ 465]        :                                       mov dx,byte_no
[ 466]        :                                       mul dx
[ 467]        :                                       add ax,offset pc_table
[ 468]        :                                       mov pointer,ax
[ 469]        :                                       xor ax,ax
[ 470]        :                                       xor dx,dx
[ 471]        :                                       
[ 472]        :                                       
[ 473]        :                                       mov cx,8
[ 474]        :                                       again:
[ 475]        :                                       xor bx,bx
[ 476]        :                                       xor ax,ax
[ 477]        :                                       mov bx,pointer
[ 478]        :                                       mov al,[bx]
[ 479]        :                                       xor bx,bx
[ 480]        :                                       mov dx,8
[ 481]        :                                       div dl
[ 482]        :                                       cmp ah,00h
[ 483]        :                                       jnz skip_check
[ 484]        :                                       dec al
[ 485]        :                                       mov ah,08
[ 486]        :                                       skip_check:
[ 487]        :                                       mov selected_byte,al;**** ;maybe al and ah need to be switched, you need to check it out
[ 488]        :                                       mov selected_bit,ah
[ 489]        :                                       mov bx,offset key
[ 490]        :                                       xor ax,ax
[ 491]        :                                       mov al,addpara
[ 492]        :                                       add bx,ax ;in case you want to add by a certain parameter you can use addpara otherwise keep it zero.beware addpara has to be byte size
[ 493]        :                                       xor ax,ax
[ 494]        :                                       mov al,selected_byte
[ 495]        :                                       add bx,ax ;bx gets the offset of the selected byte
[ 496]        :                                       mov dl,[bx] ;the selected byte copy to dl
[ 497]        :                                       
[ 498]        :                                       ;finds the selected bit using "and" and "shl"
[ 499]        :                                       ;you need to add "cmp" before the "jnz endd".you need to add shr's(after delete this comment)
[ 500]        :                                       cmp selected_bit,1
[ 501]        :                                       jnz skip_1
[ 502]        :                                       and dl,10000000b
[ 503]        :                                       jmp endd
[ 504]        :                                       skip_1:
[ 505]        :                                       cmp selected_bit,2
[ 506]        :                                       jnz skip_2
[ 507]        :                                       and dl,01000000b
[ 508]        :                                       shl dl,1
[ 509]        :                                       jmp endd
[ 510]        :                                       skip_2:
[ 511]        :                                       cmp selected_bit,3
[ 512]        :                                       jnz skip_3
[ 513]        :                                       and dl,00100000b
[ 514]        :                                       shl dl,2
[ 515]        :                                       jmp endd
[ 516]        :                                       skip_3:
[ 517]        :                                       cmp selected_bit,4
[ 518]        :                                       jnz skip_4
[ 519]        :                                       and dl,00010000b
[ 520]        :                                       shl dl,3
[ 521]        :                                       jmp endd
[ 522]        :                                       skip_4:
[ 523]        :                                       cmp selected_bit,5
[ 524]        :                                       jnz skip_5
[ 525]        :                                       and dl,00001000b
[ 526]        :                                       shl dl,4
[ 527]        :                                       jmp endd
[ 528]        :                                       skip_5:
[ 529]        :                                       cmp selected_bit,6
[ 530]        :                                       jnz skip_6
[ 531]        :                                       and dl,00000100b
[ 532]        :                                       shl dl,5
[ 533]        :                                       jmp endd
[ 534]        :                                       skip_6:
[ 535]        :                                       cmp selected_bit,7
[ 536]        :                                       jnz skip_7
[ 537]        :                                       and dl,00000010b
[ 538]        :                                       shl dl,6
[ 539]        :                                       jmp endd
[ 540]        :                                       skip_7:
[ 541]        :                                       cmp selected_bit,8
[ 542]        :                                       jnz endd
[ 543]        :                                       and dl,00000001b
[ 544]        :                                       shl dl,7
[ 545]        :                                       endd:
[ 546]        :                                       nop
[ 547]        :                                       
[ 548]        :                                       
[ 549]        :                                       cmp byte_builder_pointer,0
[ 550]        :                                       
[ 551]        :                                       jnz bit_1
[ 552]        :                                       
[ 553]        :                                       cmp dl,10000000b
[ 554]        :                                       jnz end_bit_0
[ 555]        :                                       xor temp_byte,10000000b
[ 556]        :                                       end_bit_0:
[ 557]        :                                       jmp end_builder
[ 558]        :                                       
[ 559]        :                                       bit_1:
[ 560]        :                                       
[ 561]        :                                       cmp byte_builder_pointer,1
[ 562]        :                                       
[ 563]        :                                       jnz bit_2
[ 564]        :                                       
[ 565]        :                                       cmp dl,10000000b
[ 566]        :                                       jnz end_bit_1
[ 567]        :                                       xor temp_byte,01000000b
[ 568]        :                                       end_bit_1:
[ 569]        :                                       jmp end_builder
[ 570]        :                                       
[ 571]        :                                       bit_2:
[ 572]        :                                       
[ 573]        :                                       cmp byte_builder_pointer,2
[ 574]        :                                       
[ 575]        :                                       jnz bit_3
[ 576]        :                                       
[ 577]        :                                       cmp dl,10000000b
[ 578]        :                                       jnz end_bit_2
[ 579]        :                                       xor temp_byte,00100000b
[ 580]        :                                       end_bit_2:
[ 581]        :                                       jmp end_builder
[ 582]        :                                       
[ 583]        :                                       bit_3:
[ 584]        :                                       
[ 585]        :                                       cmp byte_builder_pointer,3
[ 586]        :                                       
[ 587]        :                                       jnz bit_4
[ 588]        :                                       
[ 589]        :                                       cmp dl,10000000b
[ 590]        :                                       jnz end_bit_3
[ 591]        :                                       xor temp_byte,00010000b
[ 592]        :                                       end_bit_3:
[ 593]        :                                       jmp end_builder
[ 594]        :                                       
[ 595]        :                                       bit_4:
[ 596]        :                                       
[ 597]        :                                       cmp byte_builder_pointer,4
[ 598]        :                                       
[ 599]        :                                       jnz bit_5
[ 600]        :                                       
[ 601]        :                                       cmp dl,10000000b
[ 602]        :                                       jnz end_bit_4
[ 603]        :                                       xor temp_byte,00001000b
[ 604]        :                                       end_bit_4:
[ 605]        :                                       jmp end_builder
[ 606]        :                                       
[ 607]        :                                       bit_5:
[ 608]        :                                       
[ 609]        :                                       cmp byte_builder_pointer,5
[ 610]        :                                       
[ 611]        :                                       jnz bit_6
[ 612]        :                                       
[ 613]        :                                       cmp dl,10000000b
[ 614]        :                                       jnz end_bit_5
[ 615]        :                                       xor temp_byte,00000100b
[ 616]        :                                       end_bit_5:
[ 617]        :                                       jmp end_builder
[ 618]        :                                       
[ 619]        :                                       bit_6:
[ 620]        :                                       
[ 621]        :                                       cmp byte_builder_pointer,6
[ 622]        :                                       
[ 623]        :                                       jnz bit_7
[ 624]        :                                       
[ 625]        :                                       cmp dl,10000000b
[ 626]        :                                       jnz end_bit_6
[ 627]        :                                       xor temp_byte,00000010b
[ 628]        :                                       end_bit_6:
[ 629]        :                                       jmp end_builder
[ 630]        :                                       
[ 631]        :                                       bit_7:
[ 632]        :                                       
[ 633]        :                                       cmp byte_builder_pointer,7
[ 634]        :                                       
[ 635]        :                                       jnz end_builder
[ 636]        :                                       
[ 637]        :                                       cmp dl,10000000b
[ 638]        :                                       jnz end_bit_7
[ 639]        :                                       xor temp_byte,00000001b
[ 640]        :                                       end_bit_7:
[ 641]        :                                       end_builder:
[ 642]        :                                       nop
[ 643]        :                                       
[ 644]        :                                       
[ 645]        :                                       inc pointer
[ 646]        :                                       inc byte_builder_pointer
[ 647]        :                                       loop again
[ 648]        :                                       
[ 649]        :                                       popa
[ 650]        :                                       
[ 651]        :                                       endm permute_key
[ 652]        :                                       ;arranges k_plus and do left shifts
[ 653]        :                                       ;get: ekey
[ 654]        :                                       ;return:c,d
[ 655]    0CBB:                                       proc arrange_k_plus
[ 656]        :                                       
[ 657]    0CBB: 60                                    pusha
[ 658]    0CBC: 33 C0                                 xor ax,ax
[ 659]    0CBE: 33 F6                                 xor si,si
[ 660]    0CC0: B9 07 00                              mov cx,7
[ 661]    0CC3:                                       agn_prmt_key:
[ 662]    0CC3: 60 33 C0 33 DB 33 C9 33 D2 C7 06 53   permute_key pc_1,si,ekey,0
                03 00 00 C6 06 51 03 00 C6 06 52 03 
                00 B8 08 00 8B D6 F7 E2 05 10 00 A3 
                53 03 33 C0 33 D2 B9 08 00 33 DB 33 
                C0 8B 1E 53 03 8A 07 33 DB BA 08 00 
                F6 F2 80 FC 00 75 04 FE C8 B4 08 A2 
                4F 03 88 26 50 03 BB 08 00 33 C0 B0 
                00 03 D8 33 C0 A0 4F 03 03 D8 8A 17 
                80 3E 50 03 01 75 06 80 E2 80 E9 8A 
                00 80 3E 50 03 02 75 07 80 E2 40 D0 
                E2 EB 7C 80 3E 50 03 03 75 09 80 E2 
                20 D0 E2 D0 E2 EB 6C 80 3E 50 03 04 
                75 0B 80 E2 10 D0 E2 D0 E2 D0 E2 EB 
                5A 80 3E 50 03 05 75 0D 80 E2 08 D0 
                E2 D0 E2 D0 E2 D0 E2 EB 46 80 3E 50 
                03 06 75 0F 80 E2 04 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 30 80 3E 50 03 07 
                75 11 80 E2 02 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 18 80 3E 50 03 08 
                75 11 80 E2 01 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 D0 E2 90 80 3E 52 03 
                00 75 0D 80 FA 80 75 05 80 36 51 03 
                80 E9 83 00 80 3E 52 03 01 75 0C 80 
                FA 80 75 05 80 36 51 03 40 EB 70 80 
                3E 52 03 02 75 0C 80 FA 80 75 05 80 
                36 51 03 20 EB 5D 80 3E 52 03 03 75 
                0C 80 FA 80 75 05 80 36 51 03 10 EB 
                4A 80 3E 52 03 04 75 0C 80 FA 80 75 
                05 80 36 51 03 08 EB 37 80 3E 52 03 
                05 75 0C 80 FA 80 75 05 80 36 51 03 
                04 EB 24 80 3E 52 03 06 75 0C 80 FA 
                80 75 05 80 36 51 03 02 EB 11 80 3E 
                52 03 07 75 0A 80 FA 80 75 05 80 36 
                51 03 01 90 FF 06 53 03 FE 06 52 03 
                49 E3 03 E9 8F FE 61                
[ 663]    0E62: A0 51 03                              mov al,temp_byte
[ 664]    0E65: 88 84 48 03                           mov k_plus+si,al
[ 665]    0E69: 46                                    inc si
[ 666]    0E6A: 49 E3 03 E9 53 FE                     loop agn_prmt_key
[ 667]        :                                       
[ 668]    0E70: 33 DB                                 xor bx,bx
[ 669]    0E72: 8A 1E 49 03                           mov bl,k_plus+1
[ 670]    0E76: 89 1E 57 03                           mov k_plus_l+2,bx
[ 671]    0E7A: 8A 1E 48 03                           mov bl,k_plus
[ 672]    0E7E: 89 1E 58 03                           mov k_plus_l+3,bx
[ 673]        :                                       
[ 674]    0E82: 8A 1E 4B 03                           mov bl,k_plus+3
[ 675]    0E86: 8A 3E 4A 03                           mov bh,k_plus+2
[ 676]    0E8A: 80 E3 F0                              and bl,11110000b
[ 677]    0E8D: 89 1E 55 03                           mov k_plus_l,bx
[ 678]        :                                       
[ 679]    0E91: 33 DB                                 xor bx,bx
[ 680]    0E93: 8A 3E 4B 03                           mov bh,k_plus+3
[ 681]    0E97: 80 E7 0F                              and bh,00001111b
[ 682]    0E9A: 8A 1E 4C 03                           mov bl,k_plus+4
[ 683]    0E9E: 89 1E 5B 03                           mov k_plus_r+2,bx
[ 684]    0EA2: 8A 3E 4D 03                           mov bh,k_plus+5
[ 685]    0EA6: 8A 1E 4E 03                           mov bl,k_plus+6
[ 686]    0EAA: 89 1E 59 03                           mov k_plus_r,bx
[ 687]        :                                       
[ 688]    0EAE: 33 C0                                 xor ax,ax
[ 689]    0EB0: 33 D2                                 xor dx,dx
[ 690]    0EB2: 33 FF                                 xor di,di
[ 691]    0EB4: 33 DB                                 xor bx,bx
[ 692]    0EB6: 33 F6                                 xor si,si
[ 693]    0EB8: B9 10 00                              mov cx,16
[ 694]    0EBB: BF 02 00                              mov di,2
[ 695]    0EBE: A1 55 03                              mov ax,k_plus_l+0
[ 696]    0EC1: 8B 16 57 03                           mov dx,k_plus_l+2
[ 697]    0EC5:                                       shuv:
[ 698]    0EC5: 51                                    push cx
[ 699]    0EC6: 33 C9                                 xor cx,cx
[ 700]    0EC8: 8A 8C 5D 03                           mov cl,shifts+si
[ 701]    0ECC:                                       shft:
[ 702]    0ECC: D1 D0                                 rcl ax,1
[ 703]    0ECE: 9C                                    pushf
[ 704]    0ECF: 25 FE FF                              and ax,1111111111111110b
[ 705]    0ED2: D1 D2                                 rcl dx,1
[ 706]    0ED4: 9C                                    pushf
[ 707]    0ED5: 83 E2 FE                              and dx,1111111111111110b
[ 708]    0ED8: 9D                                    popf
[ 709]    0ED9: 73 03                                 jnc cont
[ 710]    0EDB: 0D 10 00                              or ax,0000000000010000b
[ 711]    0EDE:                                       cont:
[ 712]    0EDE: 9D                                    popf
[ 713]    0EDF: 73 03                                 jnc sof
[ 714]    0EE1: 83 CA 01                              or dx,0000000000000001b
[ 715]    0EE4:                                       sof:
[ 716]    0EE4: E2 E6                                 loop shft
[ 717]    0EE6: 89 87 6D 03                           mov c+bx,ax
[ 718]    0EEA: 89 95 6D 03                           mov c+di,dx
[ 719]    0EEE: 46                                    inc si
[ 720]    0EEF: 83 C3 04                              add bx,4
[ 721]    0EF2: 83 C7 04                              add di,4
[ 722]    0EF5: 59                                    pop cx
[ 723]    0EF6: E2 CD                                 loop shuv
[ 724]        :                                       
[ 725]    0EF8: 33 C0                                 xor ax,ax
[ 726]    0EFA: 33 DB                                 xor bx,bx
[ 727]    0EFC: 33 F6                                 xor si,si
[ 728]    0EFE: 33 FF                                 xor di,di
[ 729]    0F00: 33 C9                                 xor cx,cx
[ 730]    0F02: 33 D2                                 xor dx,dx
[ 731]        :                                       
[ 732]        :                                       
[ 733]    0F04: BF 02 00                              mov di,2
[ 734]    0F07: A1 59 03                              mov ax,k_plus_r+0
[ 735]    0F0A: 8B 16 5B 03                           mov dx,k_plus_r+2
[ 736]    0F0E: B1 04                                 mov cl,4
[ 737]    0F10:                                       shftt:
[ 738]    0F10: D1 D0                                 rcl ax,1
[ 739]    0F12: 9C                                    pushf
[ 740]    0F13: 25 FE FF                              and ax,1111111111111110b
[ 741]    0F16: D1 D2                                 rcl dx,1
[ 742]    0F18: 9C                                    pushf
[ 743]    0F19: 83 E2 FE                              and dx,1111111111111110b
[ 744]    0F1C: 9D                                    popf
[ 745]    0F1D: 73 03                                 jnc contt
[ 746]    0F1F: 0D 10 00                              or ax,0000000000010000b
[ 747]    0F22:                                       contt:
[ 748]    0F22: 9D                                    popf
[ 749]    0F23: 73 03                                 jnc soff
[ 750]    0F25: 83 CA 01                              or dx,0000000000000001b
[ 751]    0F28:                                       soff:
[ 752]    0F28: E2 E6                                 loop shftt
[ 753]    0F2A: A3 59 03                              mov k_plus_r+0,ax
[ 754]    0F2D: 89 16 5B 03                           mov k_plus_r+2,dx
[ 755]        :                                       
[ 756]    0F31: 33 C0                                 xor ax,ax
[ 757]    0F33: 33 DB                                 xor bx,bx
[ 758]    0F35: 33 F6                                 xor si,si
[ 759]    0F37: 33 FF                                 xor di,di
[ 760]    0F39: 33 C9                                 xor cx,cx
[ 761]    0F3B: 33 D2                                 xor dx,dx
[ 762]        :                                       
[ 763]    0F3D: B9 10 00                              mov cx,16
[ 764]    0F40: BF 02 00                              mov di,2
[ 765]    0F43: A1 59 03                              mov ax,k_plus_r+0
[ 766]    0F46: 8B 16 5B 03                           mov dx,k_plus_r+2
[ 767]    0F4A:                                       shuvvv:
[ 768]    0F4A: 51                                    push cx
[ 769]    0F4B: 33 C9                                 xor cx,cx
[ 770]    0F4D: 8A 8C 5D 03                           mov cl,shifts+si
[ 771]    0F51:                                       shfttt:
[ 772]    0F51: D1 D0                                 rcl ax,1
[ 773]    0F53: 9C                                    pushf
[ 774]    0F54: 25 FE FF                              and ax,1111111111111110b
[ 775]    0F57: D1 D2                                 rcl dx,1
[ 776]    0F59: 9C                                    pushf
[ 777]    0F5A: 83 E2 FE                              and dx,1111111111111110b
[ 778]    0F5D: 9D                                    popf
[ 779]    0F5E: 73 03                                 jnc conttt
[ 780]    0F60: 0D 10 00                              or ax,0000000000010000b
[ 781]    0F63:                                       conttt:
[ 782]    0F63: 9D                                    popf
[ 783]    0F64: 73 03                                 jnc sofff
[ 784]    0F66: 83 CA 01                              or dx,0000000000000001b
[ 785]    0F69:                                       sofff:
[ 786]    0F69: E2 E6                                 loop shfttt
[ 787]    0F6B: 89 87 AD 03                           mov d+bx,ax
[ 788]    0F6F: 89 95 AD 03                           mov d+di,dx
[ 789]    0F73: 46                                    inc si
[ 790]    0F74: 83 C3 04                              add bx,4
[ 791]    0F77: 83 C7 04                              add di,4
[ 792]    0F7A: 59                                    pop cx
[ 793]    0F7B: E2 CD                                 loop shuvvv
[ 794]        :                                       
[ 795]        :                                       
[ 796]    0F7D: 61                                    popa
[ 797]    0F7E: C3                                    ret
[ 798]        :                                       endp arrange_k_plus
[ 799]        :                                       ;join lefts part of k with right parts of k
[ 800]        :                                       ;get:c,d
[ 801]        :                                       ;return:cd
[ 802]    0F7F:                                       proc join_16_cd
[ 803]    0F7F: 60                                    pusha
[ 804]    0F80: 33 FF                                 xor di,di
[ 805]    0F82: 33 F6                                 xor si,si
[ 806]    0F84: 33 C9                                 xor cx,cx
[ 807]    0F86: BF 02 00                              mov di,2
[ 808]    0F89: B9 10 00                              mov cx,16
[ 809]        :                                       
[ 810]    0F8C:                                       repeat:
[ 811]    0F8C: 33 DB                                 xor bx,bx
[ 812]    0F8E: 33 C0                                 xor ax,ax
[ 813]    0F90: 33 D2                                 xor dx,dx
[ 814]        :                                       
[ 815]    0F92: C6 06 51 03 00                        mov temp_byte,0h
[ 816]    0F97: 8B 85 6D 03                           mov ax,c+di
[ 817]    0F9B: 88 A4 ED 03                           mov cd+si,ah
[ 818]    0F9F: 46                                    inc si
[ 819]    0FA0: 88 84 ED 03                           mov cd+si,al
[ 820]    0FA4: 46                                    inc si
[ 821]    0FA5: 83 EF 02                              sub di,2
[ 822]    0FA8: 8B 85 6D 03                           mov ax,c+di
[ 823]    0FAC: 88 A4 ED 03                           mov cd+si,ah
[ 824]    0FB0: 46                                    inc si
[ 825]    0FB1: 83 C7 02                              add di,2
[ 826]        :                                       
[ 827]    0FB4: A2 51 03                              mov temp_byte,al
[ 828]    0FB7: 8B 95 AD 03                           mov dx,d+di
[ 829]    0FBB: 80 E6 F0                              and dh,11110000b
[ 830]    0FBE: D0 EE D0 EE D0 EE D0 EE               shr dh,4
[ 831]    0FC6: 08 36 51 03                           or temp_byte,dh
[ 832]    0FCA: 8A 1E 51 03                           mov bl,temp_byte
[ 833]    0FCE: 88 9C ED 03                           mov cd+si,bl
[ 834]    0FD2: 8B 9D AD 03                           mov bx,d+di
[ 835]    0FD6: 80 E7 0F                              and bh,00001111b
[ 836]    0FD9: 89 9D AD 03                           mov d+di,bx
[ 837]    0FDD: 83 EF 02                              sub di,2
[ 838]    0FE0: 46                                    inc si
[ 839]        :                                       
[ 840]        :                                       ;shift left for c
[ 841]    0FE1: 8B 9D AD 03                           mov bx,d+di
[ 842]    0FE5: 89 1E 5D 04                           mov temp_dword,bx
[ 843]    0FE9: 8B 9D AF 03                           mov bx,d+di+2
[ 844]    0FED: 89 1E 5F 04                           mov temp_dword+2,bx
[ 845]    0FF1: 60 33 C0 33 DB 33 F6 33 FF 33 C9 33   shift_left temp_dword,4
                D2 BF 02 00 A1 5D 04 8B 16 5F 04 B1 
                04 D1 D0 9C 25 FE FF D1 D2 9C 83 E2 
                FE 9D 73 03 0D 10 00 9D 73 03 83 CA 
                01 E2 E6 A3 5D 04 89 16 5F 04 61    
[ 846]        :                                       ;trans temp_dword to cd
[ 847]    102C: 8B 16 5F 04                           mov dx,temp_dword+2
[ 848]    1030: 88 B4 ED 03                           mov cd+si,dh
[ 849]    1034: 46                                    inc si
[ 850]    1035: 88 94 ED 03                           mov cd+si,dl
[ 851]    1039: 46                                    inc si
[ 852]    103A: 8B 16 5D 04                           mov dx,temp_dword+0
[ 853]    103E: 88 B4 ED 03                           mov cd+si,dh
[ 854]    1042: 46                                    inc si
[ 855]    1043: 83 C7 06                              add di,6
[ 856]    1046: 49 E3 03 E9 40 FF                     loop repeat
[ 857]    104C: 61                                    popa
[ 858]    104D: C3                                    ret
[ 859]        :                                       endp join_16_cd
[ 860]        :                                       ;the proc generates k using permutation with pc2
[ 861]        :                                       ;get:cd
[ 862]        :                                       ;return:k
[ 863]    104E:                                       proc generate_k
[ 864]        :                                       
[ 865]    104E: 60                                    pusha
[ 866]    104F: 33 C9                                 xor cx,cx
[ 867]    1051: 33 F6                                 xor si,si
[ 868]    1053: 33 FF                                 xor di,di
[ 869]    1055: 33 DB                                 xor bx,bx
[ 870]    1057: 33 C0                                 xor ax,ax
[ 871]    1059: C6 06 C1 04 00                        mov para,0h
[ 872]    105E: B9 10 00                              mov cx,16
[ 873]    1061:                                       repeat3:
[ 874]    1061: 51                                    push cx
[ 875]    1062: B9 06 00                              mov cx,6
[ 876]    1065:                                       repeat2:
[ 877]    1065: 60 33 C0 33 DB 33 C9 33 D2 C7 06 53   permute_key pc_2,di,cd,para
                03 00 00 C6 06 51 03 00 C6 06 52 03 
                00 B8 08 00 8B D7 F7 E2 05 48 00 A3 
                53 03 33 C0 33 D2 B9 08 00 33 DB 33 
                C0 8B 1E 53 03 8A 07 33 DB BA 08 00 
                F6 F2 80 FC 00 75 04 FE C8 B4 08 A2 
                4F 03 88 26 50 03 BB ED 03 33 C0 A0 
                C1 04 03 D8 33 C0 A0 4F 03 03 D8 8A 
                17 80 3E 50 03 01 75 06 80 E2 80 E9 
                8A 00 80 3E 50 03 02 75 07 80 E2 40 
                D0 E2 EB 7C 80 3E 50 03 03 75 09 80 
                E2 20 D0 E2 D0 E2 EB 6C 80 3E 50 03 
                04 75 0B 80 E2 10 D0 E2 D0 E2 D0 E2 
                EB 5A 80 3E 50 03 05 75 0D 80 E2 08 
                D0 E2 D0 E2 D0 E2 D0 E2 EB 46 80 3E 
                50 03 06 75 0F 80 E2 04 D0 E2 D0 E2 
                D0 E2 D0 E2 D0 E2 EB 30 80 3E 50 03 
                07 75 11 80 E2 02 D0 E2 D0 E2 D0 E2 
                D0 E2 D0 E2 D0 E2 EB 18 80 3E 50 03 
                08 75 11 80 E2 01 D0 E2 D0 E2 D0 E2 
                D0 E2 D0 E2 D0 E2 D0 E2 90 80 3E 52 
                03 00 75 0D 80 FA 80 75 05 80 36 51 
                03 80 E9 83 00 80 3E 52 03 01 75 0C 
                80 FA 80 75 05 80 36 51 03 40 EB 70 
                80 3E 52 03 02 75 0C 80 FA 80 75 05 
                80 36 51 03 20 EB 5D 80 3E 52 03 03 
                75 0C 80 FA 80 75 05 80 36 51 03 10 
                EB 4A 80 3E 52 03 04 75 0C 80 FA 80 
                75 05 80 36 51 03 08 EB 37 80 3E 52 
                03 05 75 0C 80 FA 80 75 05 80 36 51 
                03 04 EB 24 80 3E 52 03 06 75 0C 80 
                FA 80 75 05 80 36 51 03 02 EB 11 80 
                3E 52 03 07 75 0A 80 FA 80 75 05 80 
                36 51 03 01 90 FF 06 53 03 FE 06 52 
                03 49 E3 03 E9 8E FE 61             
[ 878]    1205: A0 51 03                              mov al,temp_byte
[ 879]    1208: 88 84 61 04                           mov k+si,al
[ 880]    120C: 46                                    inc si
[ 881]    120D: 47                                    inc di
[ 882]    120E: 49 E3 03 E9 51 FE                     loop repeat2
[ 883]    1214: 33 FF                                 xor di,di
[ 884]    1216: 80 06 C1 04 07                        add para,7
[ 885]    121B: 59                                    pop cx
[ 886]    121C: 49 E3 03 E9 3F FE                     loop repeat3
[ 887]    1222: 61                                    popa
[ 888]    1223: C3                                    ret
[ 889]        :                                       endp generate_k
[ 890]        :                                       ;arranges ip using permutate m with ip_tbl, and arranges l_0 and r_0
[ 891]        :                                       ;get: m
[ 892]        :                                       ;return: l_0,r_0
[ 893]    1224:                                       proc arrange_ip
[ 894]    1224: 60                                    pusha
[ 895]    1225: 33 C9                                 xor cx,cx
[ 896]    1227: 33 F6                                 xor si,si
[ 897]    1229: 33 C0                                 xor ax,ax
[ 898]    122B: B9 08 00                              mov cx,8
[ 899]    122E:                                       agn:
[ 900]    122E: 60 33 C0 33 DB 33 C9 33 D2 C7 06 53   permute_key ip_tbl,si,m,0
                03 00 00 C6 06 51 03 00 C6 06 52 03 
                00 B8 08 00 8B D6 F7 E2 05 78 00 A3 
                53 03 33 C0 33 D2 B9 08 00 33 DB 33 
                C0 8B 1E 53 03 8A 07 33 DB BA 08 00 
                F6 F2 80 FC 00 75 04 FE C8 B4 08 A2 
                4F 03 88 26 50 03 BB 00 00 33 C0 B0 
                00 03 D8 33 C0 A0 4F 03 03 D8 8A 17 
                80 3E 50 03 01 75 06 80 E2 80 E9 8A 
                00 80 3E 50 03 02 75 07 80 E2 40 D0 
                E2 EB 7C 80 3E 50 03 03 75 09 80 E2 
                20 D0 E2 D0 E2 EB 6C 80 3E 50 03 04 
                75 0B 80 E2 10 D0 E2 D0 E2 D0 E2 EB 
                5A 80 3E 50 03 05 75 0D 80 E2 08 D0 
                E2 D0 E2 D0 E2 D0 E2 EB 46 80 3E 50 
                03 06 75 0F 80 E2 04 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 30 80 3E 50 03 07 
                75 11 80 E2 02 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 18 80 3E 50 03 08 
                75 11 80 E2 01 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 D0 E2 90 80 3E 52 03 
                00 75 0D 80 FA 80 75 05 80 36 51 03 
                80 E9 83 00 80 3E 52 03 01 75 0C 80 
                FA 80 75 05 80 36 51 03 40 EB 70 80 
                3E 52 03 02 75 0C 80 FA 80 75 05 80 
                36 51 03 20 EB 5D 80 3E 52 03 03 75 
                0C 80 FA 80 75 05 80 36 51 03 10 EB 
                4A 80 3E 52 03 04 75 0C 80 FA 80 75 
                05 80 36 51 03 08 EB 37 80 3E 52 03 
                05 75 0C 80 FA 80 75 05 80 36 51 03 
                04 EB 24 80 3E 52 03 06 75 0C 80 FA 
                80 75 05 80 36 51 03 02 EB 11 80 3E 
                52 03 07 75 0A 80 FA 80 75 05 80 36 
                51 03 01 90 FF 06 53 03 FE 06 52 03 
                49 E3 03 E9 8F FE 61                
[ 901]    13CD: A0 51 03                              mov al,temp_byte
[ 902]    13D0: 88 84 C2 04                           mov ip+si,al
[ 903]    13D4: 46                                    inc si
[ 904]    13D5: 49 E3 03 E9 53 FE                     loop agn
[ 905]    13DB: 33 C9                                 xor cx,cx
[ 906]    13DD: 33 F6                                 xor si,si
[ 907]    13DF: 33 C0                                 xor ax,ax
[ 908]    13E1: 33 FF                                 xor di,di
[ 909]    13E3: B9 04 00                              mov cx,4
[ 910]    13E6:                                       agn2:
[ 911]    13E6: 8A 84 C2 04                           mov al,ip+si
[ 912]    13EA: 88 85 CA 04                           mov l_0+di,al
[ 913]    13EE: 47                                    inc di
[ 914]    13EF: 46                                    inc si
[ 915]    13F0: E2 F4                                 loop agn2
[ 916]    13F2: B9 04 00                              mov cx,4
[ 917]    13F5: 33 FF                                 xor di,di
[ 918]    13F7:                                       agn3:
[ 919]    13F7: 8A 84 C2 04                           mov al,ip+si
[ 920]    13FB: 88 85 CE 04                           mov r_0+di,al
[ 921]    13FF: 47                                    inc di
[ 922]    1400: 46                                    inc si
[ 923]    1401: E2 F4                                 loop agn3
[ 924]        :                                       
[ 925]    1403: 61                                    popa
[ 926]    1404: C3                                    ret
[ 927]        :                                       endp arrange_ip
[ 928]        :                                       ;the proc creating next l using feistel
[ 929]        :                                       ;get: r_0/r
[ 930]        :                                       ;return:l,lp
[ 931]    1405:                                       proc create_l
[ 932]    1405: 60                                    pusha
[ 933]    1406: 33 F6                                 xor si,si;l index pointer(0 is 1, 1 is 2 and so on..)
[ 934]    1408: 33 FF                                 xor di,di;l byte pointer
[ 935]    140A: 33 C0                                 xor ax,ax
[ 936]    140C: 33 C9                                 xor cx,cx
[ 937]        :                                       ;create l_1
[ 938]        :                                       
[ 939]        :                                       ;1
[ 940]    140E: 80 3E 58 05 00                        cmp l_index,0
[ 941]    1413: 75 10                                 jnz skp_i0
[ 942]    1415: B9 04 00                              mov cx,4
[ 943]    1418:                                       cpy:
[ 944]    1418: 8A 85 CE 04                           mov al,r_0+di
[ 945]    141C: 88 85 D2 04                           mov l+di,al
[ 946]    1420: 47                                    inc di
[ 947]    1421: E2 F5                                 loop cpy
[ 948]    1423: EB 24                                 jmp end_i
[ 949]        :                                       
[ 950]    1425:                                       skp_i0:
[ 951]        :                                       ;create l_2-16
[ 952]    1425: 33 C9                                 xor cx,cx
[ 953]    1427: 33 F6                                 xor si,si
[ 954]    1429: 33 C0                                 xor ax,ax
[ 955]    142B: B9 04 00                              mov cx,4
[ 956]        :                                       ;copy old l to lp
[ 957]    142E:                                       cpy_lp:
[ 958]    142E: 8A 84 D2 04                           mov al,l+si
[ 959]    1432: 88 84 74 05                           mov lp+si,al
[ 960]    1436: 46                                    inc si
[ 961]    1437: E2 F5                                 loop cpy_lp
[ 962]        :                                       
[ 963]        :                                       ;copy old r to l
[ 964]    1439: 33 F6                                 xor si,si
[ 965]    143B: B9 04 00                              mov cx,4
[ 966]    143E:                                       cpy_r2l:
[ 967]    143E: 8A 84 12 05                           mov al,r+si
[ 968]    1442: 88 84 D2 04                           mov l+si,al
[ 969]    1446: 46                                    inc si
[ 970]    1447: E2 F5                                 loop cpy_r2l
[ 971]    1449:                                       end_i:
[ 972]    1449: FE 06 58 05                           inc l_index
[ 973]        :                                       
[ 974]    144D: 61                                    popa
[ 975]    144E: C3                                    ret
[ 976]        :                                       endp create_l
[ 977]        :                                       ;the proc creating next r using feistel
[ 978]        :                                       ;get: l
[ 979]        :                                       ;return:r,rp
[ 980]    144F:                                       proc dec_r
[ 981]    144F: 60                                    pusha
[ 982]        :                                       ;create rp(previous r)
[ 983]    1450: BE 12 05                              mov si,offset r
[ 984]    1453: BF 80 05                              mov di,offset rp
[ 985]    1456: B9 04 00                              mov cx,4
[ 986]    1459: F3                                    rep
[ 987]    145A: A4                                    movsb
[ 988]        :                                       ;copy old l to r
[ 989]    145B: BE D2 04                              mov si,offset l
[ 990]    145E: BF 12 05                              mov di,offset r
[ 991]    1461: B9 04 00                              mov cx,4
[ 992]    1464: F3                                    rep
[ 993]    1465: A4                                    movsb
[ 994]    1466: FE 0E 59 05                           dec r_index
[ 995]    146A: 61                                    popa
[ 996]    146B: C3                                    ret
[ 997]        :                                       endp dec_r
[ 998]        :                                       ;creates r using feistel
[ 999]        :                                       ;get:l/l_0,k
[1000]        :                                       ;return:r
[1001]    146C:                                       proc create_r
[1002]    146C: 60                                    pusha
[1003]        :                                       
[1004]    146D: 33 F6                                 xor si,si
[1005]    146F: 33 FF                                 xor di,di
[1006]    1471: 33 FF                                 xor di,di
[1007]    1473: 33 C0                                 xor ax,ax
[1008]    1475: 33 C9                                 xor cx,cx
[1009]    1477: 33 DB                                 xor bx,bx
[1010]    1479: C6 06 C1 04 00                        mov para,0h
[1011]        :                                       ;function f
[1012]        :                                       ;generate e,
[1013]    147E: 80 3E 59 05 00                        cmp r_index,0
[1014]    1483: 74 03 E9 B4 01                        jnz cont1
[1015]    1488: B9 06 00                              mov cx,6
[1016]    148B:                                       agn4:
[1017]    148B: 60 33 C0 33 DB 33 C9 33 D2 C7 06 53   permute_key e_tbl,si,r_0,0
                03 00 00 C6 06 51 03 00 C6 06 52 03 
                00 B8 08 00 8B D6 F7 E2 05 B8 00 A3 
                53 03 33 C0 33 D2 B9 08 00 33 DB 33 
                C0 8B 1E 53 03 8A 07 33 DB BA 08 00 
                F6 F2 80 FC 00 75 04 FE C8 B4 08 A2 
                4F 03 88 26 50 03 BB CE 04 33 C0 B0 
                00 03 D8 33 C0 A0 4F 03 03 D8 8A 17 
                80 3E 50 03 01 75 06 80 E2 80 E9 8A 
                00 80 3E 50 03 02 75 07 80 E2 40 D0 
                E2 EB 7C 80 3E 50 03 03 75 09 80 E2 
                20 D0 E2 D0 E2 EB 6C 80 3E 50 03 04 
                75 0B 80 E2 10 D0 E2 D0 E2 D0 E2 EB 
                5A 80 3E 50 03 05 75 0D 80 E2 08 D0 
                E2 D0 E2 D0 E2 D0 E2 EB 46 80 3E 50 
                03 06 75 0F 80 E2 04 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 30 80 3E 50 03 07 
                75 11 80 E2 02 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 18 80 3E 50 03 08 
                75 11 80 E2 01 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 D0 E2 90 80 3E 52 03 
                00 75 0D 80 FA 80 75 05 80 36 51 03 
                80 E9 83 00 80 3E 52 03 01 75 0C 80 
                FA 80 75 05 80 36 51 03 40 EB 70 80 
                3E 52 03 02 75 0C 80 FA 80 75 05 80 
                36 51 03 20 EB 5D 80 3E 52 03 03 75 
                0C 80 FA 80 75 05 80 36 51 03 10 EB 
                4A 80 3E 52 03 04 75 0C 80 FA 80 75 
                05 80 36 51 03 08 EB 37 80 3E 52 03 
                05 75 0C 80 FA 80 75 05 80 36 51 03 
                04 EB 24 80 3E 52 03 06 75 0C 80 FA 
                80 75 05 80 36 51 03 02 EB 11 80 3E 
                52 03 07 75 0A 80 FA 80 75 05 80 36 
                51 03 01 90 FF 06 53 03 FE 06 52 03 
                49 E3 03 E9 8F FE 61                
[1018]    162A: 8A 1E 51 03                           mov bl,temp_byte
[1019]    162E: 88 9C 52 05                           mov e+si,bl
[1020]    1632: 46                                    inc si
[1021]    1633: 49 E3 03 E9 52 FE                     loop agn4
[1022]    1639: E9 B1 01                              jmp endd_e
[1023]        :                                       
[1024]    163C:                                       cont1:
[1025]    163C: B9 06 00                              mov cx,6
[1026]    163F:                                       agn5:
[1027]    163F: 60 33 C0 33 DB 33 C9 33 D2 C7 06 53   permute_key e_tbl,si,r,0
                03 00 00 C6 06 51 03 00 C6 06 52 03 
                00 B8 08 00 8B D6 F7 E2 05 B8 00 A3 
                53 03 33 C0 33 D2 B9 08 00 33 DB 33 
                C0 8B 1E 53 03 8A 07 33 DB BA 08 00 
                F6 F2 80 FC 00 75 04 FE C8 B4 08 A2 
                4F 03 88 26 50 03 BB 12 05 33 C0 B0 
                00 03 D8 33 C0 A0 4F 03 03 D8 8A 17 
                80 3E 50 03 01 75 06 80 E2 80 E9 8A 
                00 80 3E 50 03 02 75 07 80 E2 40 D0 
                E2 EB 7C 80 3E 50 03 03 75 09 80 E2 
                20 D0 E2 D0 E2 EB 6C 80 3E 50 03 04 
                75 0B 80 E2 10 D0 E2 D0 E2 D0 E2 EB 
                5A 80 3E 50 03 05 75 0D 80 E2 08 D0 
                E2 D0 E2 D0 E2 D0 E2 EB 46 80 3E 50 
                03 06 75 0F 80 E2 04 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 30 80 3E 50 03 07 
                75 11 80 E2 02 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 18 80 3E 50 03 08 
                75 11 80 E2 01 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 D0 E2 90 80 3E 52 03 
                00 75 0D 80 FA 80 75 05 80 36 51 03 
                80 E9 83 00 80 3E 52 03 01 75 0C 80 
                FA 80 75 05 80 36 51 03 40 EB 70 80 
                3E 52 03 02 75 0C 80 FA 80 75 05 80 
                36 51 03 20 EB 5D 80 3E 52 03 03 75 
                0C 80 FA 80 75 05 80 36 51 03 10 EB 
                4A 80 3E 52 03 04 75 0C 80 FA 80 75 
                05 80 36 51 03 08 EB 37 80 3E 52 03 
                05 75 0C 80 FA 80 75 05 80 36 51 03 
                04 EB 24 80 3E 52 03 06 75 0C 80 FA 
                80 75 05 80 36 51 03 02 EB 11 80 3E 
                52 03 07 75 0A 80 FA 80 75 05 80 36 
                51 03 01 90 FF 06 53 03 FE 06 52 03 
                49 E3 03 E9 8F FE 61                
[1028]    17DE: 8A 1E 51 03                           mov bl,temp_byte
[1029]    17E2: 88 9C 52 05                           mov e+si,bl
[1030]    17E6: 46                                    inc si
[1031]    17E7: 49 E3 03 E9 52 FE                     loop agn5
[1032]    17ED:                                       endd_e:
[1033]        :                                       
[1034]    17ED: 33 F6                                 xor si,si
[1035]    17EF: 33 FF                                 xor di,di
[1036]    17F1: A0 59 05                              mov al,r_index
[1037]    17F4: B3 06                                 mov bl,6
[1038]    17F6: F6 E3                                 mul bl
[1039]    17F8: A2 C1 04                              mov para,al
[1040]        :                                       
[1041]    17FB: 60 33 F6 33 C0 33 D2 33 C9 33 FF B0   xor_multibytes e,k,6,0,para
                00 8B F8 A0 C1 04 8B F0 33 C0 B9 06 
                00 8A 85 52 05 8A 94 61 04 32 C2 88 
                85 52 05 46 47 E2 EE 61             
[1042]        :                                       
[1043]    1827: E8 C3 02                              call generate_8_b
[1044]    182A: E8 4C 03                              call access_s_boxes
[1045]    182D: E8 27 04                              call arrange_f
[1046]        :                                       
[1047]        :                                       ;1
[1048]    1830: 80 3E 59 05 00                        cmp r_index,0
[1049]    1835: 75 2D                                 jnz skp_bld0
[1050]        :                                       
[1051]    1837: 60 33 F6 33 C0 33 D2 33 C9 33 FF B0   xor_multibytes f,l_0,4,0,0
                00 8B F8 B0 00 8B F0 33 C0 B9 04 00 
                8A 85 68 05 8A 94 CA 04 32 C2 88 85 
                68 05 46 47 E2 EE 61                
[1052]    1862: EB 2B                                 jmp skp_rest
[1053]        :                                       
[1054]        :                                       ;2-16
[1055]    1864:                                       skp_bld0:
[1056]    1864: 60 33 F6 33 C0 33 D2 33 C9 33 FF B0   xor_multibytes f,lp,4,0,0
                00 8B F8 B0 00 8B F0 33 C0 B9 04 00 
                8A 85 68 05 8A 94 74 05 32 C2 88 85 
                68 05 46 47 E2 EE 61                
[1057]        :                                       
[1058]    188F:                                       skp_rest:
[1059]        :                                       
[1060]    188F: 33 F6                                 xor si,si
[1061]    1891: 33 C9                                 xor cx,cx
[1062]    1893: 33 C0                                 xor ax,ax
[1063]    1895: B9 04 00                              mov cx,4
[1064]        :                                       
[1065]    1898:                                       cpy2:
[1066]    1898: 8A 84 68 05                           mov al,f+si
[1067]    189C: 88 84 12 05                           mov r+si,al
[1068]    18A0: 46                                    inc si
[1069]    18A1: E2 F5                                 loop cpy2
[1070]        :                                       
[1071]    18A3: FE 06 59 05                           inc r_index
[1072]    18A7: 61                                    popa
[1073]    18A8: C3                                    ret
[1074]        :                                       endp create_r
[1075]        :                                       ;creates r using feistel
[1076]        :                                       ;get:r,k
[1077]        :                                       ;return:l
[1078]    18A9:                                       proc dec_l
[1079]    18A9: 60                                    pusha
[1080]    18AA: 33 C0                                 xor ax,ax
[1081]    18AC: 33 F6                                 xor si,si
[1082]    18AE: 33 FF                                 xor di,di
[1083]    18B0: 33 DB                                 xor bx,bx
[1084]    18B2: 33 C9                                 xor cx,cx
[1085]        :                                       
[1086]        :                                       ;f function decryption
[1087]        :                                       ;generate b
[1088]    18B4: B9 06 00                              mov cx,6
[1089]    18B7:                                       dec_b:
[1090]    18B7: 60 33 C0 33 DB 33 C9 33 D2 C7 06 53   permute_key e_tbl,si,l,0
                03 00 00 C6 06 51 03 00 C6 06 52 03 
                00 B8 08 00 8B D6 F7 E2 05 B8 00 A3 
                53 03 33 C0 33 D2 B9 08 00 33 DB 33 
                C0 8B 1E 53 03 8A 07 33 DB BA 08 00 
                F6 F2 80 FC 00 75 04 FE C8 B4 08 A2 
                4F 03 88 26 50 03 BB D2 04 33 C0 B0 
                00 03 D8 33 C0 A0 4F 03 03 D8 8A 17 
                80 3E 50 03 01 75 06 80 E2 80 E9 8A 
                00 80 3E 50 03 02 75 07 80 E2 40 D0 
                E2 EB 7C 80 3E 50 03 03 75 09 80 E2 
                20 D0 E2 D0 E2 EB 6C 80 3E 50 03 04 
                75 0B 80 E2 10 D0 E2 D0 E2 D0 E2 EB 
                5A 80 3E 50 03 05 75 0D 80 E2 08 D0 
                E2 D0 E2 D0 E2 D0 E2 EB 46 80 3E 50 
                03 06 75 0F 80 E2 04 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 30 80 3E 50 03 07 
                75 11 80 E2 02 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 18 80 3E 50 03 08 
                75 11 80 E2 01 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 D0 E2 90 80 3E 52 03 
                00 75 0D 80 FA 80 75 05 80 36 51 03 
                80 E9 83 00 80 3E 52 03 01 75 0C 80 
                FA 80 75 05 80 36 51 03 40 EB 70 80 
                3E 52 03 02 75 0C 80 FA 80 75 05 80 
                36 51 03 20 EB 5D 80 3E 52 03 03 75 
                0C 80 FA 80 75 05 80 36 51 03 10 EB 
                4A 80 3E 52 03 04 75 0C 80 FA 80 75 
                05 80 36 51 03 08 EB 37 80 3E 52 03 
                05 75 0C 80 FA 80 75 05 80 36 51 03 
                04 EB 24 80 3E 52 03 06 75 0C 80 FA 
                80 75 05 80 36 51 03 02 EB 11 80 3E 
                52 03 07 75 0A 80 FA 80 75 05 80 36 
                51 03 01 90 FF 06 53 03 FE 06 52 03 
                49 E3 03 E9 8F FE 61                
[1091]    1A56: 8A 1E 51 03                           mov bl,temp_byte
[1092]    1A5A: 88 9C 52 05                           mov e+si,bl
[1093]    1A5E: 46                                    inc si
[1094]    1A5F: 49 E3 03 E9 52 FE                     loop dec_b
[1095]        :                                       
[1096]    1A65: 33 F6                                 xor si,si
[1097]    1A67: 33 FF                                 xor di,di
[1098]    1A69: A0 58 05                              mov al,l_index
[1099]    1A6C: B3 06                                 mov bl,6
[1100]    1A6E: F6 E3                                 mul bl
[1101]    1A70: A2 C1 04                              mov para,al
[1102]        :                                       
[1103]    1A73: 60 33 F6 33 C0 33 D2 33 C9 33 FF B0   xor_multibytes e,k,6,0,para
                00 8B F8 A0 C1 04 8B F0 33 C0 B9 06 
                00 8A 85 52 05 8A 94 61 04 32 C2 88 
                85 52 05 46 47 E2 EE 61             
[1104]        :                                       
[1105]    1A9F: E8 4B 00                              call generate_8_b
[1106]    1AA2: E8 D4 00                              call access_s_boxes
[1107]    1AA5: E8 AF 01                              call arrange_f
[1108]        :                                       
[1109]    1AA8: 60 33 F6 33 C0 33 D2 33 C9 33 FF B0   xor_multibytes f,rp,4,0,0
                00 8B F8 B0 00 8B F0 33 C0 B9 04 00 
                8A 85 68 05 8A 94 80 05 32 C2 88 85 
                68 05 46 47 E2 EE 61                
[1110]        :                                       
[1111]    1AD3: 33 F6                                 xor si,si
[1112]    1AD5: 33 C9                                 xor cx,cx
[1113]    1AD7: 33 C0                                 xor ax,ax
[1114]    1AD9: B9 04 00                              mov cx,4
[1115]        :                                       
[1116]    1ADC:                                       cpy_f2l:
[1117]    1ADC: 8A 84 68 05                           mov al,f+si
[1118]    1AE0: 88 84 D2 04                           mov l+si,al
[1119]    1AE4: 46                                    inc si
[1120]    1AE5: E2 F5                                 loop cpy_f2l
[1121]        :                                       
[1122]    1AE7: FE 0E 58 05                           dec l_index
[1123]    1AEB: 61                                    popa
[1124]    1AEC: C3                                    ret
[1125]        :                                       endp dec_l
[1126]        :                                       
[1127]        :                                       
[1128]        :                                       
[1129]        :                                       ;the macro do xor for to multibytes arrays
[1130]        :                                       ;it gets 2 vars, and return the xored data to the 1st var
[1131]        :                                       ;also it gets no of bytes in each array
[1132]        :                                       ;add para to add certain parameter otherwise keep it zero
[1133]        :                                       macro xor_multibytes var1,var2,bytes_no,addpara1,addpara2
[1134]        :                                       pusha
[1135]        :                                       LOCAL again
[1136]        :                                       xor si,si
[1137]        :                                       xor ax,ax
[1138]        :                                       xor dx,dx
[1139]        :                                       xor cx,cx
[1140]        :                                       xor di,di
[1141]        :                                       mov al,addpara1
[1142]        :                                       mov di,ax
[1143]        :                                       mov al,addpara2
[1144]        :                                       mov si,ax
[1145]        :                                       xor ax,ax
[1146]        :                                       mov cx,bytes_no
[1147]        :                                       again:
[1148]        :                                       mov al,var1+di
[1149]        :                                       mov dl,var2+si
[1150]        :                                       xor al,dl
[1151]        :                                       mov var1+di,al
[1152]        :                                       inc si
[1153]        :                                       inc di
[1154]        :                                       loop again
[1155]        :                                       popa
[1156]        :                                       endm xor_multibytes
[1157]        :                                       ;the proc generates 8 groups of 6 bits b
[1158]        :                                       ;get:e
[1159]        :                                       ;return:b
[1160]    1AED:                                       proc generate_8_b
[1161]    1AED: 60                                    pusha
[1162]    1AEE: 33 F6                                 xor si,si
[1163]    1AF0: 33 C9                                 xor cx,cx
[1164]    1AF2: C6 06 51 03 00                        mov temp_byte,0h
[1165]        :                                       ;zero b
[1166]    1AF7: B9 08 00                              mov cx,8
[1167]    1AFA:                                       agn6:
[1168]    1AFA: C6 84 5A 05 00                        mov b+si,0h
[1169]    1AFF: 46                                    inc si
[1170]    1B00: E2 F8                                 loop agn6
[1171]        :                                       
[1172]        :                                       ;taking first 6 bits from e and put them
[1173]        :                                       ;into first cell of b
[1174]    1B02: 33 F6                                 xor si,si
[1175]    1B04: 33 FF                                 xor di,di
[1176]    1B06: 33 C0                                 xor ax,ax
[1177]    1B08: 33 DB                                 xor bx,bx
[1178]    1B0A: 33 C9                                 xor cx,cx
[1179]        :                                       ;building 4 chunks of 6 bits
[1180]        :                                       ;doing this twice
[1181]    1B0C: B9 02 00                              mov cx,2
[1182]    1B0F:                                       agn7:
[1183]        :                                       
[1184]    1B0F: 8A 84 52 05                           mov al,e+si
[1185]    1B13: 24 FC                                 and al,11111100b
[1186]    1B15: 88 85 5A 05                           mov b+di,al
[1187]    1B19: 47                                    inc di
[1188]        :                                       
[1189]        :                                       
[1190]    1B1A: 8A 84 52 05                           mov al,e+si
[1191]    1B1E: 24 03                                 and al,00000011b
[1192]    1B20: D0 E0 D0 E0 D0 E0 D0 E0 D0 E0 D0 E0   shl al,6
                                                    
[1193]    1B2C: 46                                    inc si
[1194]    1B2D: 8A 9C 52 05                           mov bl,e+si
[1195]    1B31: 80 E3 F0                              and bl,11110000b
[1196]    1B34: D0 EB D0 EB                           shr bl,2
[1197]    1B38: 0A D8                                 or bl,al
[1198]    1B3A: 88 9D 5A 05                           mov b+di,bl
[1199]    1B3E: 47                                    inc di
[1200]        :                                       
[1201]    1B3F: 8A 9C 52 05                           mov bl,e+si
[1202]    1B43: 80 E3 0F                              and bl,00001111b
[1203]    1B46: D0 E3 D0 E3 D0 E3 D0 E3               shl bl,4
[1204]    1B4E: 46                                    inc si
[1205]    1B4F: 8A 84 52 05                           mov al,e+si
[1206]    1B53: 24 C0                                 and al,11000000b
[1207]    1B55: D0 E8 D0 E8 D0 E8 D0 E8               shr al,4
[1208]    1B5D: 0A D8                                 or bl,al
[1209]    1B5F: 88 9D 5A 05                           mov b+di,bl
[1210]    1B63: 47                                    inc di
[1211]        :                                       
[1212]    1B64: 8A 9C 52 05                           mov bl,e+si
[1213]    1B68: 80 E3 3F                              and bl,00111111b
[1214]    1B6B: D0 E3 D0 E3                           shl bl,2
[1215]    1B6F: 46                                    inc si
[1216]    1B70: 88 9D 5A 05                           mov b+di,bl
[1217]    1B74: 47                                    inc di
[1218]    1B75: E2 98                                 loop agn7
[1219]    1B77: 61                                    popa
[1220]    1B78: C3                                    ret
[1221]        :                                       endp generate_8_b
[1222]        :                                       ;the proc replaces b with s-box data
[1223]        :                                       ;get:b
[1224]        :                                       ;return:s
[1225]    1B79:                                       proc access_s_boxes
[1226]    1B79: 60                                    pusha
[1227]    1B7A: 33 C0                                 xor ax,ax
[1228]    1B7C: 33 F6                                 xor si,si
[1229]    1B7E: 33 C9                                 xor cx,cx
[1230]    1B80: B9 08 00                              mov cx,8
[1231]        :                                       
[1232]    1B83:                                       agn_box:
[1233]        :                                       ;find s box row
[1234]    1B83: 8A A4 5A 05                           mov ah,b+si
[1235]    1B87: 80 E4 04                              and ah,00000100b
[1236]    1B8A: D0 EC D0 EC                           shr ah,2
[1237]    1B8E: 8A C4                                 mov al,ah
[1238]    1B90: 8A A4 5A 05                           mov ah,b+si
[1239]    1B94: 80 E4 80                              and ah,10000000b
[1240]    1B97: D0 EC D0 EC D0 EC D0 EC D0 EC D0 EC   shr ah,6
                                                    
[1241]    1BA3: 0A C4                                 or al,ah
[1242]    1BA5: A2 62 05                              mov s_row,al
[1243]        :                                       
[1244]        :                                       ;find s box column
[1245]    1BA8: 33 C0                                 xor ax,ax
[1246]    1BAA: 8A 84 5A 05                           mov al,b+si
[1247]    1BAE: 24 78                                 and al,01111000b
[1248]    1BB0: D0 E8 D0 E8 D0 E8                     shr al,3
[1249]    1BB6: A2 63 05                              mov s_column,al
[1250]        :                                       
[1251]        :                                       ;access to s box
[1252]    1BB9: 33 FF                                 xor di,di
[1253]    1BBB: 33 C0                                 xor ax,ax
[1254]    1BBD: 33 DB                                 xor bx,bx
[1255]    1BBF: A0 62 05                              mov al,s_row
[1256]    1BC2: B3 10                                 mov bl,16
[1257]    1BC4: F6 E3                                 mul bl
[1258]    1BC6: 02 06 63 05                           add al,s_column
[1259]    1BCA: 8B F8                                 mov di,ax
[1260]        :                                       
[1261]        :                                       
[1262]    1BCC: 33 DB                                 xor bx,bx
[1263]        :                                       ;s1
[1264]    1BCE: 83 FE 00                              cmp si,0
[1265]    1BD1: 75 06                                 jnz box2
[1266]    1BD3: 8A 9D E8 00                           mov bl,s1+di
[1267]    1BD7: EB 4B                                 jmp end_box
[1268]        :                                       
[1269]        :                                       ;s2
[1270]    1BD9:                                       box2:
[1271]    1BD9: 83 FE 01                              cmp si,1
[1272]    1BDC: 75 06                                 jnz box3
[1273]    1BDE: 8A 9D 28 01                           mov bl,s2+di
[1274]    1BE2: EB 40                                 jmp end_box
[1275]        :                                       
[1276]        :                                       ;s3
[1277]    1BE4:                                       box3:
[1278]    1BE4: 83 FE 02                              cmp si,2
[1279]    1BE7: 75 06                                 jnz box4
[1280]    1BE9: 8A 9D 68 01                           mov bl,s3+di
[1281]    1BED: EB 35                                 jmp end_box
[1282]        :                                       
[1283]        :                                       ;s4
[1284]    1BEF:                                       box4:
[1285]    1BEF: 83 FE 03                              cmp si,3
[1286]    1BF2: 75 06                                 jnz box5
[1287]    1BF4: 8A 9D A8 01                           mov bl,s4+di
[1288]    1BF8: EB 2A                                 jmp end_box
[1289]        :                                       
[1290]        :                                       ;s5
[1291]    1BFA:                                       box5:
[1292]    1BFA: 83 FE 04                              cmp si,4
[1293]    1BFD: 75 06                                 jnz box6
[1294]    1BFF: 8A 9D E8 01                           mov bl,s5+di
[1295]    1C03: EB 1F                                 jmp end_box
[1296]        :                                       
[1297]        :                                       ;s6
[1298]    1C05:                                       box6:
[1299]    1C05: 83 FE 05                              cmp si,5
[1300]    1C08: 75 06                                 jnz box7
[1301]    1C0A: 8A 9D 28 02                           mov bl,s6+di
[1302]    1C0E: EB 14                                 jmp end_box
[1303]        :                                       
[1304]        :                                       ;s7
[1305]    1C10:                                       box7:
[1306]    1C10: 83 FE 06                              cmp si,6
[1307]    1C13: 75 06                                 jnz box8
[1308]    1C15: 8A 9D 68 02                           mov bl,s7+di
[1309]    1C19: EB 09                                 jmp end_box
[1310]        :                                       
[1311]        :                                       ;s8
[1312]    1C1B:                                       box8:
[1313]    1C1B: 83 FE 07                              cmp si,7
[1314]    1C1E: 75 04                                 jnz end_box
[1315]    1C20: 8A 9D A8 02                           mov bl,s8+di
[1316]        :                                       
[1317]    1C24:                                       end_box:
[1318]        :                                       
[1319]    1C24: 88 9C 64 05                           mov s+si,bl
[1320]        :                                       
[1321]    1C28: 46                                    inc si
[1322]    1C29: 49 E3 03 E9 54 FF                     loop agn_box
[1323]        :                                       
[1324]    1C2F: 33 C0                                 xor ax,ax
[1325]    1C31: 33 F6                                 xor si,si
[1326]    1C33: 33 FF                                 xor di,di
[1327]    1C35: 33 C9                                 xor cx,cx
[1328]    1C37: B9 04 00                              mov cx,4
[1329]    1C3A:                                       agn_arr:
[1330]    1C3A: 8A 84 64 05                           mov al,s+si
[1331]    1C3E: D0 E0 D0 E0 D0 E0 D0 E0               shl al,4
[1332]    1C46: 46                                    inc si
[1333]    1C47: 8A A4 64 05                           mov ah,s+si
[1334]    1C4B: 0A C4                                 or al,ah
[1335]    1C4D: 46                                    inc si
[1336]    1C4E: 88 85 64 05                           mov s+di,al
[1337]    1C52: 47                                    inc di
[1338]    1C53: E2 E5                                 loop agn_arr
[1339]        :                                       
[1340]    1C55: 61                                    popa
[1341]    1C56: C3                                    ret
[1342]        :                                       endp access_s_boxes
[1343]        :                                       ;the proc arranges and permutate f
[1344]        :                                       ;get:s
[1345]        :                                       ;return:f
[1346]    1C57:                                       proc arrange_f
[1347]    1C57: 60                                    pusha
[1348]    1C58: 33 C0                                 xor ax,ax
[1349]    1C5A: 33 F6                                 xor si,si
[1350]    1C5C: 33 C9                                 xor cx,cx
[1351]        :                                       
[1352]    1C5E: B9 04 00                              mov cx,4
[1353]    1C61: 33 F6                                 xor si,si
[1354]    1C63:                                       agnf:
[1355]    1C63: 60 33 C0 33 DB 33 C9 33 D2 C7 06 53   permute_key p,si,s,0
                03 00 00 C6 06 51 03 00 C6 06 52 03 
                00 B8 08 00 8B D6 F7 E2 05 E8 02 A3 
                53 03 33 C0 33 D2 B9 08 00 33 DB 33 
                C0 8B 1E 53 03 8A 07 33 DB BA 08 00 
                F6 F2 80 FC 00 75 04 FE C8 B4 08 A2 
                4F 03 88 26 50 03 BB 64 05 33 C0 B0 
                00 03 D8 33 C0 A0 4F 03 03 D8 8A 17 
                80 3E 50 03 01 75 06 80 E2 80 E9 8A 
                00 80 3E 50 03 02 75 07 80 E2 40 D0 
                E2 EB 7C 80 3E 50 03 03 75 09 80 E2 
                20 D0 E2 D0 E2 EB 6C 80 3E 50 03 04 
                75 0B 80 E2 10 D0 E2 D0 E2 D0 E2 EB 
                5A 80 3E 50 03 05 75 0D 80 E2 08 D0 
                E2 D0 E2 D0 E2 D0 E2 EB 46 80 3E 50 
                03 06 75 0F 80 E2 04 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 30 80 3E 50 03 07 
                75 11 80 E2 02 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 18 80 3E 50 03 08 
                75 11 80 E2 01 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 D0 E2 90 80 3E 52 03 
                00 75 0D 80 FA 80 75 05 80 36 51 03 
                80 E9 83 00 80 3E 52 03 01 75 0C 80 
                FA 80 75 05 80 36 51 03 40 EB 70 80 
                3E 52 03 02 75 0C 80 FA 80 75 05 80 
                36 51 03 20 EB 5D 80 3E 52 03 03 75 
                0C 80 FA 80 75 05 80 36 51 03 10 EB 
                4A 80 3E 52 03 04 75 0C 80 FA 80 75 
                05 80 36 51 03 08 EB 37 80 3E 52 03 
                05 75 0C 80 FA 80 75 05 80 36 51 03 
                04 EB 24 80 3E 52 03 06 75 0C 80 FA 
                80 75 05 80 36 51 03 02 EB 11 80 3E 
                52 03 07 75 0A 80 FA 80 75 05 80 36 
                51 03 01 90 FF 06 53 03 FE 06 52 03 
                49 E3 03 E9 8F FE 61                
[1356]    1E02: A0 51 03                              mov al,temp_byte
[1357]    1E05: 88 84 68 05                           mov f+si,al
[1358]    1E09: 46                                    inc si
[1359]    1E0A: 49 E3 03 E9 53 FE                     loop agnf
[1360]        :                                       
[1361]        :                                       
[1362]    1E10: 61                                    popa
[1363]    1E11: C3                                    ret
[1364]        :                                       endp arrange_f
[1365]        :                                       ;the proc joins encrypted rl
[1366]        :                                       ;get:r,l
[1367]        :                                       ;return:rl
[1368]    1E12:                                       proc join_rl
[1369]    1E12: 60                                    pusha
[1370]    1E13: 33 C0                                 xor ax,ax
[1371]    1E15: 33 F6                                 xor si,si
[1372]    1E17: 33 C9                                 xor cx,cx
[1373]        :                                       
[1374]    1E19: B9 04 00                              mov cx,4
[1375]    1E1C:                                       cpy_r:
[1376]    1E1C: 8A 84 12 05                           mov al,r+si
[1377]    1E20: 88 84 78 05                           mov rl+si,al
[1378]    1E24: 46                                    inc si
[1379]    1E25: E2 F5                                 loop cpy_r
[1380]        :                                       
[1381]    1E27: 33 C0                                 xor ax,ax
[1382]    1E29: 33 FF                                 xor di,di
[1383]    1E2B: B9 04 00                              mov cx,4
[1384]    1E2E:                                       cpy_l:
[1385]    1E2E: 8A 85 D2 04                           mov al,l+di
[1386]    1E32: 88 84 78 05                           mov rl+si,al
[1387]    1E36: 46                                    inc si
[1388]    1E37: 47                                    inc di
[1389]    1E38: E2 F4                                 loop cpy_l
[1390]        :                                       
[1391]    1E3A: 33 FF                                 xor di,di
[1392]    1E3C: 33 C9                                 xor cx,cx
[1393]    1E3E: 33 C0                                 xor ax,ax
[1394]    1E40: B9 08 00                              mov cx,8
[1395]    1E43:                                       agn_pr:
[1396]    1E43: 60 33 C0 33 DB 33 C9 33 D2 C7 06 53   permute_key pc_minus,di,rl,0
                03 00 00 C6 06 51 03 00 C6 06 52 03 
                00 B8 08 00 8B D7 F7 E2 05 08 03 A3 
                53 03 33 C0 33 D2 B9 08 00 33 DB 33 
                C0 8B 1E 53 03 8A 07 33 DB BA 08 00 
                F6 F2 80 FC 00 75 04 FE C8 B4 08 A2 
                4F 03 88 26 50 03 BB 78 05 33 C0 B0 
                00 03 D8 33 C0 A0 4F 03 03 D8 8A 17 
                80 3E 50 03 01 75 06 80 E2 80 E9 8A 
                00 80 3E 50 03 02 75 07 80 E2 40 D0 
                E2 EB 7C 80 3E 50 03 03 75 09 80 E2 
                20 D0 E2 D0 E2 EB 6C 80 3E 50 03 04 
                75 0B 80 E2 10 D0 E2 D0 E2 D0 E2 EB 
                5A 80 3E 50 03 05 75 0D 80 E2 08 D0 
                E2 D0 E2 D0 E2 D0 E2 EB 46 80 3E 50 
                03 06 75 0F 80 E2 04 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 30 80 3E 50 03 07 
                75 11 80 E2 02 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 18 80 3E 50 03 08 
                75 11 80 E2 01 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 D0 E2 90 80 3E 52 03 
                00 75 0D 80 FA 80 75 05 80 36 51 03 
                80 E9 83 00 80 3E 52 03 01 75 0C 80 
                FA 80 75 05 80 36 51 03 40 EB 70 80 
                3E 52 03 02 75 0C 80 FA 80 75 05 80 
                36 51 03 20 EB 5D 80 3E 52 03 03 75 
                0C 80 FA 80 75 05 80 36 51 03 10 EB 
                4A 80 3E 52 03 04 75 0C 80 FA 80 75 
                05 80 36 51 03 08 EB 37 80 3E 52 03 
                05 75 0C 80 FA 80 75 05 80 36 51 03 
                04 EB 24 80 3E 52 03 06 75 0C 80 FA 
                80 75 05 80 36 51 03 02 EB 11 80 3E 
                52 03 07 75 0A 80 FA 80 75 05 80 36 
                51 03 01 90 FF 06 53 03 FE 06 52 03 
                49 E3 03 E9 8F FE 61                
[1397]    1FE2: A0 51 03                              mov al,temp_byte
[1398]    1FE5: 88 85 8C 05                           mov enc_msg+di,al
[1399]    1FE9: 47                                    inc di
[1400]    1FEA: 49 E3 03 E9 53 FE                     loop agn_pr
[1401]    1FF0: 61                                    popa
[1402]    1FF1: C3                                    ret
[1403]        :                                       endp join_rl
[1404]        :                                       ;the proc joins decrypted lr
[1405]        :                                       ;get:l,r
[1406]        :                                       ;return:lr
[1407]    1FF2:                                       proc  join_dec_lr
[1408]    1FF2: 60                                    pusha
[1409]    1FF3: 33 FF                                 xor di,di
[1410]    1FF5: 33 C9                                 xor cx,cx
[1411]    1FF7: 33 C0                                 xor ax,ax
[1412]    1FF9: 33 F6                                 xor si,si
[1413]    1FFB: B9 04 00                              mov cx,4
[1414]    1FFE:                                       copy_l:
[1415]    1FFE: 8A 84 D2 04                           mov al,l+si
[1416]    2002: 88 05                                 mov m+di,al
[1417]    2004: 46                                    inc si
[1418]    2005: 47                                    inc di
[1419]    2006: E2 F6                                 loop copy_l
[1420]        :                                       
[1421]        :                                       
[1422]    2008: 33 C9                                 xor cx,cx
[1423]    200A: 33 C0                                 xor ax,ax
[1424]    200C: 33 F6                                 xor si,si
[1425]    200E: B9 04 00                              mov cx,4
[1426]    2011:                                       copy_r:
[1427]    2011: 8A 84 12 05                           mov al,r+si
[1428]    2015: 88 05                                 mov m+di,al
[1429]    2017: 46                                    inc si
[1430]    2018: 47                                    inc di
[1431]    2019: E2 F6                                 loop copy_r
[1432]    201B: 61                                    popa
[1433]    201C: C3                                    ret
[1434]        :                                       endp  join_dec_lr
[1435]        :                                       ;the proc divide the encrypted msg
[1436]        :                                       ;get:
[1437]        :                                       ;return: r,l
[1438]    201D:                                       proc divide_enc_msg
[1439]    201D: 60                                    pusha
[1440]    201E: 33 C9                                 xor cx,cx
[1441]    2020: 33 F6                                 xor si,si
[1442]    2022: 33 FF                                 xor di,di
[1443]    2024: 33 C0                                 xor ax,ax
[1444]    2026: B9 04 00                              mov cx,4
[1445]    2029:                                       copy_right:
[1446]    2029: 8A 05                                 mov al,m+di
[1447]    202B: 88 84 12 05                           mov r+si,al
[1448]    202F: 46                                    inc si
[1449]    2030: 47                                    inc di
[1450]    2031: E2 F6                                 loop copy_right
[1451]    2033: 33 F6                                 xor si,si
[1452]    2035: B9 04 00                              mov cx,4
[1453]    2038:                                       copy_left:
[1454]    2038: 8A 05                                 mov al,m+di
[1455]    203A: 88 84 D2 04                           mov l+si,al
[1456]    203E: 46                                    inc si
[1457]    203F: 47                                    inc di
[1458]    2040: E2 F6                                 loop copy_left
[1459]    2042: 61                                    popa
[1460]    2043: C3                                    ret
[1461]        :                                       endp divide_enc_msg
[1462]        :                                       
[1463]    2044:                                       start:
[1464]        :                                       ; set segment registers:
[1465]    2044: B8 00 00                              mov ax, data
[1466]    2047: 8E D8                                 mov ds, ax
[1467]    2049: 8E C0                                 mov es, ax
[1468]        :                                       ;WELCOME:
[1469]        :                                       ;reset screen
[1470]    204B: E8 82 E9                              call cln_scr
[1471]    204E: 60 B4 02 B7 00 33 D2 CD 10 61         set_cur 0,0
[1472]    2058: 60 B4 09 BA 63 08 CD 21 61            print_msg welcome_msg
[1473]        :                                       ;new line
[1474]    2061: B2 0A                                 mov dl,10
[1475]    2063: B4 02                                 mov ah,2
[1476]    2065: CD 21                                 int 21h
[1477]        :                                       ;print help
[1478]    2067: 60 B4 09 BA 71 07 CD 21 61            print_msg help_msg
[1479]        :                                       ;new line
[1480]    2070: B2 0A                                 mov dl,10
[1481]    2072: B4 02                                 mov ah,2
[1482]    2074: CD 21                                 int 21h
[1483]    2076:                                       ask_again:
[1484]    2076: 60 B4 09 BA 62 07 CD 21 61            print_msg ask_command
[1485]        :                                       ;new line
[1486]    207F: B2 0A                                 mov dl,10
[1487]    2081: B4 02                                 mov ah,2
[1488]    2083: CD 21                                 int 21h
[1489]        :                                       ;get input
[1490]    2085: B4 01                                 mov ah,1
[1491]    2087: CD 21                                 int 21h
[1492]        :                                       ;reset screen
[1493]    2089: E8 44 E9                              call cln_scr
[1494]    208C: 60 B4 02 B7 00 33 D2 CD 10 61         set_cur 0,0
[1495]        :                                       ;check input
[1496]    2096: 3C 65                                 cmp al,'e'
[1497]    2098: 74 15                                 jz encrypt
[1498]    209A: 3C 45                                 cmp al,'E'
[1499]    209C: 74 11                                 jz encrypt
[1500]    209E: 3C 64                                 cmp al,"d"
[1501]    20A0: 75 03 E9 9D 00                        jz decrypt
[1502]    20A5: 3C 44                                 cmp al,"D"
[1503]    20A7: 75 03 E9 96 00                        jz decrypt
[1504]    20AC: E9 92 04                              jmp error2
[1505]        :                                       
[1506]        :                                       
[1507]        :                                       
[1508]    20AF:                                       encrypt:
[1509]        :                                       ;ENCRYPTION
[1510]        :                                       
[1511]        :                                       ;INPUT
[1512]    20AF: E8 2F E9                              call get_msgnkey
[1513]        :                                       
[1514]        :                                       ;CALCULATIONS
[1515]    20B2: E8 06 EC                              call arrange_k_plus
[1516]    20B5: E8 C7 EE                              call join_16_cd
[1517]    20B8: E8 93 EF                              call generate_k
[1518]    20BB: E8 66 F1                              call arrange_ip
[1519]    20BE: 33 C9                                 xor cx,cx
[1520]    20C0: B9 10 00                              mov cx,16
[1521]    20C3:                                       crt_l_r:
[1522]    20C3: E8 3F F3                              call create_l
[1523]    20C6: E8 A3 F3                              call create_r
[1524]    20C9: E2 F8                                 loop crt_l_r
[1525]        :                                       
[1526]    20CB: E8 44 FD                              call join_rl
[1527]        :                                       
[1528]        :                                       ;OUTPUT
[1529]    20CE: 60 33 F6 33 C0 33 C9 33 FF B9 08 00   hex2str enc_msg,enc_msg_ascii
                8A 84 8C 05 24 F0 D0 E8 D0 E8 D0 E8 
                D0 E8 3C 0A 78 09 04 37 88 85 BA 05 
                47 EB 07 04 30 88 85 BA 05 47 8A 84 
                8C 05 24 0F 3C 0A 78 09 04 37 88 85 
                BA 05 47 EB 07 04 30 88 85 BA 05 47 
                46 E2 C1 61                         
[1530]        :                                       ;reset screen
[1531]    211A: E8 B3 E8                              call cln_scr
[1532]    211D: 60 B4 02 B7 00 33 D2 CD 10 61         set_cur 0,0
[1533]    2127: 60 B4 09 BA 24 07 CD 21 61            print_msg show_enc
[1534]    2130: 60 B4 09 BA BA 05 CD 21 61            print_msg enc_msg_ascii
[1535]        :                                       
[1536]        :                                       ;new line
[1537]    2139: B2 0A                                 mov dl,10
[1538]    213B: B4 02                                 mov ah,2
[1539]    213D: CD 21                                 int 21h
[1540]    213F: E9 34 FF                              jmp ask_again
[1541]        :                                       
[1542]        :                                       
[1543]    2142:                                       decrypt:
[1544]        :                                       ;DECRYPTION
[1545]        :                                       ;INPUT
[1546]    2142: E8 08 EA                              call get_encnkey
[1547]        :                                       
[1548]        :                                       ;CALCULATIONS
[1549]        :                                       
[1550]    2145: B9 08 00                              mov cx,8
[1551]    2148: 33 F6                                 xor si,si
[1552]    214A:                                       prmt:
[1553]    214A: 60 33 C0 33 DB 33 C9 33 D2 C7 06 53   permute_key ip_tbl,si,enc_msg,0,0
                03 00 00 C6 06 51 03 00 C6 06 52 03 
                00 B8 08 00 8B D6 F7 E2 05 78 00 A3 
                53 03 33 C0 33 D2 B9 08 00 33 DB 33 
                C0 8B 1E 53 03 8A 07 33 DB BA 08 00 
                F6 F2 80 FC 00 75 04 FE C8 B4 08 A2 
                4F 03 88 26 50 03 BB 8C 05 33 C0 B0 
                00 03 D8 33 C0 A0 4F 03 03 D8 8A 17 
                80 3E 50 03 01 75 06 80 E2 80 E9 8A 
                00 80 3E 50 03 02 75 07 80 E2 40 D0 
                E2 EB 7C 80 3E 50 03 03 75 09 80 E2 
                20 D0 E2 D0 E2 EB 6C 80 3E 50 03 04 
                75 0B 80 E2 10 D0 E2 D0 E2 D0 E2 EB 
                5A 80 3E 50 03 05 75 0D 80 E2 08 D0 
                E2 D0 E2 D0 E2 D0 E2 EB 46 80 3E 50 
                03 06 75 0F 80 E2 04 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 30 80 3E 50 03 07 
                75 11 80 E2 02 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 18 80 3E 50 03 08 
                75 11 80 E2 01 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 D0 E2 90 80 3E 52 03 
                00 75 0D 80 FA 80 75 05 80 36 51 03 
                80 E9 83 00 80 3E 52 03 01 75 0C 80 
                FA 80 75 05 80 36 51 03 40 EB 70 80 
                3E 52 03 02 75 0C 80 FA 80 75 05 80 
                36 51 03 20 EB 5D 80 3E 52 03 03 75 
                0C 80 FA 80 75 05 80 36 51 03 10 EB 
                4A 80 3E 52 03 04 75 0C 80 FA 80 75 
                05 80 36 51 03 08 EB 37 80 3E 52 03 
                05 75 0C 80 FA 80 75 05 80 36 51 03 
                04 EB 24 80 3E 52 03 06 75 0C 80 FA 
                80 75 05 80 36 51 03 02 EB 11 80 3E 
                52 03 07 75 0A 80 FA 80 75 05 80 36 
                51 03 01 90 FF 06 53 03 FE 06 52 03 
                49 E3 03 E9 8F FE 61                
[1554]    22E9: A0 51 03                              mov al,temp_byte
[1555]    22EC: 88 04                                 mov m+si,al
[1556]    22EE: 46                                    inc si
[1557]    22EF: 49 E3 03 E9 55 FE                     loop prmt
[1558]    22F5: E8 25 FD                              call divide_enc_msg
[1559]    22F8: E8 C0 E9                              call arrange_k_plus
[1560]    22FB: E8 81 EC                              call join_16_cd
[1561]    22FE: E8 4D ED                              call generate_k
[1562]        :                                       
[1563]    2301: 33 C9                                 xor cx,cx
[1564]    2303: B9 10 00                              mov cx,16
[1565]    2306: C6 06 59 05 0F                        mov r_index,0fh
[1566]    230B: C6 06 58 05 0F                        mov l_index,0fh
[1567]    2310:                                       dec_l_r:
[1568]    2310: E8 3C F1                              call dec_r
[1569]    2313: E8 93 F5                              call dec_l
[1570]    2316: E2 F8                                 loop dec_l_r
[1571]        :                                       
[1572]    2318: E8 D7 FC                              call join_dec_lr
[1573]    231B: B9 08 00                              mov cx,8
[1574]    231E: 33 F6                                 xor si,si
[1575]    2320:                                       prmt2:
[1576]    2320: 60 33 C0 33 DB 33 C9 33 D2 C7 06 53   permute_key pc_minus,si,m,0,0
                03 00 00 C6 06 51 03 00 C6 06 52 03 
                00 B8 08 00 8B D6 F7 E2 05 08 03 A3 
                53 03 33 C0 33 D2 B9 08 00 33 DB 33 
                C0 8B 1E 53 03 8A 07 33 DB BA 08 00 
                F6 F2 80 FC 00 75 04 FE C8 B4 08 A2 
                4F 03 88 26 50 03 BB 00 00 33 C0 B0 
                00 03 D8 33 C0 A0 4F 03 03 D8 8A 17 
                80 3E 50 03 01 75 06 80 E2 80 E9 8A 
                00 80 3E 50 03 02 75 07 80 E2 40 D0 
                E2 EB 7C 80 3E 50 03 03 75 09 80 E2 
                20 D0 E2 D0 E2 EB 6C 80 3E 50 03 04 
                75 0B 80 E2 10 D0 E2 D0 E2 D0 E2 EB 
                5A 80 3E 50 03 05 75 0D 80 E2 08 D0 
                E2 D0 E2 D0 E2 D0 E2 EB 46 80 3E 50 
                03 06 75 0F 80 E2 04 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 30 80 3E 50 03 07 
                75 11 80 E2 02 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 EB 18 80 3E 50 03 08 
                75 11 80 E2 01 D0 E2 D0 E2 D0 E2 D0 
                E2 D0 E2 D0 E2 D0 E2 90 80 3E 52 03 
                00 75 0D 80 FA 80 75 05 80 36 51 03 
                80 E9 83 00 80 3E 52 03 01 75 0C 80 
                FA 80 75 05 80 36 51 03 40 EB 70 80 
                3E 52 03 02 75 0C 80 FA 80 75 05 80 
                36 51 03 20 EB 5D 80 3E 52 03 03 75 
                0C 80 FA 80 75 05 80 36 51 03 10 EB 
                4A 80 3E 52 03 04 75 0C 80 FA 80 75 
                05 80 36 51 03 08 EB 37 80 3E 52 03 
                05 75 0C 80 FA 80 75 05 80 36 51 03 
                04 EB 24 80 3E 52 03 06 75 0C 80 FA 
                80 75 05 80 36 51 03 02 EB 11 80 3E 
                52 03 07 75 0A 80 FA 80 75 05 80 36 
                51 03 01 90 FF 06 53 03 FE 06 52 03 
                49 E3 03 E9 8F FE 61                
[1577]    24BF: A0 51 03                              mov al,temp_byte
[1578]    24C2: 88 84 84 05                           mov dec_msg+si,al
[1579]    24C6: 46                                    inc si
[1580]    24C7: 49 E3 03 E9 53 FE                     loop prmt2
[1581]        :                                       
[1582]        :                                       ;OUTPUT
[1583]    24CD: 60 33 F6 33 C0 33 C9 33 FF B9 08 00   hex2str dec_msg,dec_msg_ascii
                8A 84 84 05 24 F0 D0 E8 D0 E8 D0 E8 
                D0 E8 3C 0A 78 09 04 37 88 85 CB 05 
                47 EB 07 04 30 88 85 CB 05 47 8A 84 
                84 05 24 0F 3C 0A 78 09 04 37 88 85 
                CB 05 47 EB 07 04 30 88 85 CB 05 47 
                46 E2 C1 61                         
[1584]        :                                       ;reset screen
[1585]    2519: E8 B4 E4                              call cln_scr
[1586]    251C: 60 B4 02 B7 00 33 D2 CD 10 61         set_cur 0,0
[1587]    2526: 60 B4 09 BA 43 07 CD 21 61            print_msg show_dec
[1588]    252F: 60 B4 09 BA CB 05 CD 21 61            print_msg dec_msg_ascii
[1589]        :                                       
[1590]        :                                       ;new line
[1591]    2538: B2 0A                                 mov dl,10
[1592]    253A: B4 02                                 mov ah,2
[1593]    253C: CD 21                                 int 21h
[1594]    253E: E9 35 FB                              jmp ask_again
[1595]        :                                       
[1596]    2541:                                       error2:
[1597]        :                                       ;reset screen
[1598]    2541: E8 8C E4                              call cln_scr
[1599]    2544: 60 B4 02 B7 00 33 D2 CD 10 61         set_cur 0,0
[1600]    254E: 60 B4 09 BA DC 05 CD 21 61            print_msg error_msg
[1601]        :                                       ; wait for any key....
[1602]    2557: B4 01                                 mov ah, 1
[1603]    2559: CD 21                                 int 21h
[1604]        :                                       ;new line
[1605]    255B: B2 0A                                 mov dl,10
[1606]    255D: B4 02                                 mov ah,2
[1607]    255F: CD 21                                 int 21h
[1608]    2561: E9 12 FB                              jmp ask_again
[1609]        :                                       
[1610]        :                                       
[1611]        :                                       
[1612]        :                                       
[1613]        :                                       
[1614]        :                                       
[1615]        :                                       
[1616]    2564: B8 00 4C                              mov ax, 4c00h ; exit to operating system.
[1617]    2567: CD 21                                 int 21h
[1618]        :                                       
[1619]        :                                       
[1620]        :                                       
[1621]        :                                       end start ; set entry point and stop the assembler.
[1622]        :                                       
[1623]        :                                       
 
===================================================================================================
 
EXE HEADER - bytes from 0000 to 01FF inclusive.

0000: 4D      -   exe signature (M)
0001: 5A      -   exe signature (Z)
0002: 69      -   bytes on last page (l.byte)
0003: 01      -   bytes on last page (h.byte)
0004: 14      -   512 byte pages in file (l.byte)
0005: 00      -   512 byte pages in file (h.byte)
0006: 01      -   relocations (l.byte)
0007: 00      -   relocations (h.byte)
0008: 20      -   paragraphs in header (l.byte)
0009: 00      -   paragraphs in header (h.byte)
000A: 00      -   minimum memory (l.byte)
000B: 00      -   minimum memory (h.byte)
000C: FF      -   maximum memory (l.byte)
000D: FF      -   maximum memory (h.byte)
000E: 8D      -   SS - stack segment (l.byte)
000F: 00      -   SS - stack segment (h.byte)
0010: 00      -   SP - stack pointer (l.byte)
0011: 01      -   SP - stack pointer (h.byte)
0012: B3      -   check sum (l.byte)
0013: 76      -   check sum (h.byte)
0014: 74      -   IP - instruction pointer (l.byte)
0015: 16      -   IP - instruction pointer (h.byte)
0016: 9D      -   CS - code segment (l.byte)
0017: 00      -   CS - code segment (h.byte)
0018: 1E      -   relocation table adress (l.byte)
0019: 00      -   relocation table adress (h.byte)
001A: 00      -   overlay number (l.byte)
001B: 00      -   overlay number (h.byte)
001C: 01      -   signature (l.byte)
001D: 00      -   signature (h.byte)
001E: 75      -   relocation table - offset inside segment (l.byte)
001F: 16      -   relocation table - offset inside segment (h.byte)
0020: 9D      -   relocation table - segment anchor (l.byte)
0021: 00      -   relocation table - segment anchor (h.byte)
0022 to 01FF  -   reserved relocation area  (00) 




===================================================================================================
